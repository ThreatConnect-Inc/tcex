

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>tcex.tcex_batch_v2 &mdash; TcEx 0.8.10 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="TcEx 0.8.10 documentation" href="../../index.html"/>
        <link rel="up" title="Module code" href="../index.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> TcEx
          

          
          </a>

          
            
            
              <div class="version">
                0.8.10
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../authorization.html">Authorization (Token / HMAC)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../batch.html">Batch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../building_apps.html">Building Apps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data_filter.html">Data Filter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development_tools.html">Development Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../exit.html">Exit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install_json.html">Install JSON</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../jobs.html">Jobs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../message_tc.html">Message TC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tcex_docs/modules.html">tcex</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../metrics.html">Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notifications.html">Notifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../parser.html">Parser / Args</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../playbook.html">Playbooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../proxies.html">Proxies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../request.html">Requests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resource.html">Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../results_tc.html">Results TC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../utils.html">Utils</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">TcEx</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>tcex.tcex_batch_v2</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for tcex.tcex_batch_v2</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;ThreatConnect Batch Import Module&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">uuid</span>

<span class="c1"># import local modules for dynamic reference</span>
<span class="n">module</span> <span class="o">=</span> <span class="nb">__import__</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="c1"># TODO: Add auto submit feature.</span>

<div class="viewcode-block" id="custom_indicator_class_factory"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.custom_indicator_class_factory">[docs]</a><span class="k">def</span> <span class="nf">custom_indicator_class_factory</span><span class="p">(</span><span class="n">indicator_type</span><span class="p">,</span> <span class="n">base_class</span><span class="p">,</span> <span class="n">class_dict</span><span class="p">,</span> <span class="n">value_fields</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Internal method for dynamically building Custom Indicator Class.&quot;&quot;&quot;</span>
    <span class="n">value_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">value_fields</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">init_1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tcex</span><span class="p">,</span> <span class="n">value1</span><span class="p">,</span> <span class="n">rating</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">confidence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Init method for Custom Indicator Types with one value&quot;&quot;&quot;</span>
        <span class="n">summary</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_summary</span><span class="p">(</span><span class="n">value1</span><span class="p">)</span>  <span class="c1"># build the indicator summary</span>
        <span class="n">base_class</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tcex</span><span class="p">,</span> <span class="n">indicator_type</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">rating</span><span class="p">,</span> <span class="n">confidence</span><span class="p">,</span> <span class="n">xid</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">class_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">init_2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tcex</span><span class="p">,</span> <span class="n">value1</span><span class="p">,</span> <span class="n">value2</span><span class="p">,</span> <span class="n">rating</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">confidence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Init method for Custom Indicator Types with two values.&quot;&quot;&quot;</span>
        <span class="n">summary</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_summary</span><span class="p">(</span><span class="n">value1</span><span class="p">,</span> <span class="n">value2</span><span class="p">)</span>  <span class="c1"># build the indicator summary</span>
        <span class="n">base_class</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tcex</span><span class="p">,</span> <span class="n">indicator_type</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">rating</span><span class="p">,</span> <span class="n">confidence</span><span class="p">,</span> <span class="n">xid</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">class_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">init_3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tcex</span><span class="p">,</span> <span class="n">value1</span><span class="p">,</span> <span class="n">value2</span><span class="p">,</span> <span class="n">value3</span><span class="p">,</span> <span class="n">rating</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">confidence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Init method for Custom Indicator Types with three values.&quot;&quot;&quot;</span>
        <span class="n">summary</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_summary</span><span class="p">(</span><span class="n">value1</span><span class="p">,</span> <span class="n">value2</span><span class="p">,</span> <span class="n">value3</span><span class="p">)</span>  <span class="c1"># build the indicator summary</span>
        <span class="n">base_class</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tcex</span><span class="p">,</span> <span class="n">indicator_type</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">rating</span><span class="p">,</span> <span class="n">confidence</span><span class="p">,</span> <span class="n">xid</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">class_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>

    <span class="n">class_name</span> <span class="o">=</span> <span class="n">indicator_type</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">init_method</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()[</span><span class="s1">&#39;init_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value_count</span><span class="p">)]</span>
    <span class="n">newclass</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">class_name</span><span class="p">),</span> <span class="p">(</span><span class="n">base_class</span><span class="p">,),</span> <span class="p">{</span><span class="s2">&quot;__init__&quot;</span><span class="p">:</span> <span class="n">init_method</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">newclass</span></div>


<div class="viewcode-block" id="TcExBatch"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.TcExBatch">[docs]</a><span class="k">class</span> <span class="nc">TcExBatch</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;ThreatConnect Batch Import Module&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tcex</span><span class="p">,</span> <span class="n">owner</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">attribute_write_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">halt_on_error</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize Class Properties.</span>

<span class="sd">        Args:</span>
<span class="sd">            tcex (obj): An instance of TcEx object.</span>
<span class="sd">            owner (str): The ThreatConnect owner for Batch action.</span>
<span class="sd">            action (str, default:Create): Action for the batch job [&#39;Create&#39;, &#39;Delete&#39;].</span>
<span class="sd">            attribute_write_type (str, default:Replace): Write type for Indicator attributes</span>
<span class="sd">                [&#39;Append&#39;, &#39;Replace&#39;].</span>
<span class="sd">            halt_on_error (bool, default:True): If True any batch error will halt the batch job.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span> <span class="o">=</span> <span class="n">tcex</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_owner</span> <span class="o">=</span> <span class="n">owner</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_action</span> <span class="o">=</span> <span class="n">action</span> <span class="ow">or</span> <span class="s1">&#39;Create&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_attribute_write_type</span> <span class="o">=</span> <span class="n">attribute_write_type</span> <span class="ow">or</span> <span class="s1">&#39;Replace&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_halt_on_error</span> <span class="o">=</span> <span class="n">halt_on_error</span>

        <span class="c1"># default properties</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_auto_submit</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_auto_submit_limit</span> <span class="o">=</span> <span class="mi">10000</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_poll_interval</span> <span class="o">=</span> <span class="mi">15</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_poll_timeout</span> <span class="o">=</span> <span class="mi">3600</span>

        <span class="c1"># containers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_files</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_groups</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_groups_by_id</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_groups_raw</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_indicators</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_indicators_raw</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># build custom indicator classes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_gen_indicator_class</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_critical_failures</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return Batch critical failure messages.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="s1">&#39;Encountered an unexpected Exception while processing batch job&#39;</span><span class="p">,</span>
            <span class="s1">&#39;would exceed the number of allowed indicators&#39;</span>
        <span class="p">]</span>

<div class="viewcode-block" id="TcExBatch._gen_indicator_class"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.TcExBatch._gen_indicator_class">[docs]</a>    <span class="k">def</span> <span class="nf">_gen_indicator_class</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate Custom Indicator Classes.&quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">indicator_types_data</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>
            <span class="n">class_name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="c1"># temp fix for API issue where boolean are returned as strings</span>
            <span class="n">entry</span><span class="p">[</span><span class="s1">&#39;custom&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">to_bool</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;custom&#39;</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">class_name</span> <span class="ow">in</span> <span class="nb">globals</span><span class="p">():</span>
                <span class="c1"># skip Indicator Type if a class already exists</span>
                <span class="k">continue</span>

            <span class="c1"># Custom Indicator can have 3 values. Only add the value if it is set.</span>
            <span class="n">value_fields</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;value1Label&#39;</span><span class="p">):</span>
                <span class="n">value_fields</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="s1">&#39;value1Label&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;value2Label&#39;</span><span class="p">):</span>
                <span class="n">value_fields</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="s1">&#39;value2Label&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;value3Label&#39;</span><span class="p">):</span>
                <span class="n">value_fields</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="s1">&#39;value3Label&#39;</span><span class="p">])</span>
            <span class="n">value_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">value_fields</span><span class="p">)</span>

            <span class="n">class_data</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="c1"># Add Class for each Custom Indicator type to this module</span>
            <span class="n">custom_class</span> <span class="o">=</span> <span class="n">custom_indicator_class_factory</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">Indicator</span><span class="p">,</span> <span class="n">class_data</span><span class="p">,</span> <span class="n">value_fields</span><span class="p">)</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">class_name</span><span class="p">,</span> <span class="n">custom_class</span><span class="p">)</span>

            <span class="c1"># Add Custom Indicator Method</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_gen_indicator_method</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">custom_class</span><span class="p">,</span> <span class="n">value_count</span><span class="p">)</span></div>

<div class="viewcode-block" id="TcExBatch._gen_indicator_method"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.TcExBatch._gen_indicator_method">[docs]</a>    <span class="k">def</span> <span class="nf">_gen_indicator_method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">custom_class</span><span class="p">,</span> <span class="n">value_count</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dynamically generate custom Indicator methods.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str): The name of the method.</span>
<span class="sd">            custom_class (object): The class to add.</span>
<span class="sd">            value_count (int): The number of value parameters to support.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">method_name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

        <span class="c1"># Add Method for each Custom Indicator class</span>
        <span class="k">def</span> <span class="nf">method_1</span><span class="p">(</span><span class="n">value1</span><span class="p">,</span> <span class="n">rating</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">confidence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Add Custom Indicator data to Batch object&quot;&quot;&quot;</span>
            <span class="n">indicator_obj</span> <span class="o">=</span> <span class="n">custom_class</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="p">,</span> <span class="n">value1</span><span class="p">,</span> <span class="n">rating</span><span class="p">,</span> <span class="n">confidence</span><span class="p">,</span> <span class="n">xid</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_indicators</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">indicator_obj</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">indicator_obj</span>

        <span class="k">def</span> <span class="nf">method_2</span><span class="p">(</span><span class="n">value1</span><span class="p">,</span> <span class="n">value2</span><span class="p">,</span> <span class="n">rating</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">confidence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Add Custom Indicator data to Batch object&quot;&quot;&quot;</span>
            <span class="n">indicator_obj</span> <span class="o">=</span> <span class="n">custom_class</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="p">,</span> <span class="n">value1</span><span class="p">,</span> <span class="n">value2</span><span class="p">,</span> <span class="n">rating</span><span class="p">,</span> <span class="n">confidence</span><span class="p">,</span> <span class="n">xid</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_indicators</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">indicator_obj</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">indicator_obj</span>

        <span class="k">def</span> <span class="nf">method_3</span><span class="p">(</span><span class="n">value1</span><span class="p">,</span> <span class="n">value2</span><span class="p">,</span> <span class="n">value3</span><span class="p">,</span> <span class="n">rating</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">confidence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Add Custom Indicator data to Batch object&quot;&quot;&quot;</span>
            <span class="n">indicator_obj</span> <span class="o">=</span> <span class="n">custom_class</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="p">,</span> <span class="n">value1</span><span class="p">,</span> <span class="n">value2</span><span class="p">,</span> <span class="n">value3</span><span class="p">,</span> <span class="n">rating</span><span class="p">,</span> <span class="n">confidence</span><span class="p">,</span> <span class="n">xid</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_indicators</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">indicator_obj</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">indicator_obj</span>

        <span class="n">method</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()[</span><span class="s1">&#39;method_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value_count</span><span class="p">)]</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method_name</span><span class="p">,</span> <span class="n">method</span><span class="p">)</span></div>

<div class="viewcode-block" id="TcExBatch._group_lookup"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.TcExBatch._group_lookup">[docs]</a>    <span class="k">def</span> <span class="nf">_group_lookup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xid</span><span class="p">,</span> <span class="n">group_obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return existing group object if exists.</span>

<span class="sd">        Args:</span>
<span class="sd">            xid (str): The xid (External ID) value for the Group.</span>
<span class="sd">            group_obj (obj): An instance of the Group object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            obj: The new group object or the previously stored object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xid</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_groups_by_id</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">xid</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">group_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_groups_by_id</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">xid</span><span class="p">)</span>
                <span class="n">group_obj</span><span class="o">.</span><span class="n">processed</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_groups_by_id</span><span class="p">[</span><span class="n">xid</span><span class="p">]</span> <span class="o">=</span> <span class="n">group_obj</span>
        <span class="k">return</span> <span class="n">group_obj</span></div>

<div class="viewcode-block" id="TcExBatch._indicator_values"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.TcExBatch._indicator_values">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_indicator_values</span><span class="p">(</span><span class="n">indicator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Process indicators expanding file hashes/custom indicators into multiple entries.</span>

<span class="sd">        Args:</span>
<span class="sd">            indicator (str): &quot; : &quot; delimited string</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: The list of indicators split on &quot; : &quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">indicator_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">indicator</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">indicator</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39; : &#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># handle all multi-valued indicators types (file hashes and custom indicators)</span>
            <span class="n">indicator_list</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="c1"># group 1 - lazy capture everything to first &lt;space&gt;:&lt;space&gt; or end of line</span>
            <span class="n">iregx_pattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;^(.*?(?=\s\:\s|$))?&#39;</span>
            <span class="n">iregx_pattern</span> <span class="o">+=</span> <span class="sa">r</span><span class="s1">&#39;(?:\s\:\s)?&#39;</span>  <span class="c1"># remove &lt;space&gt;:&lt;space&gt;</span>
            <span class="c1"># group 2 - look behind for &lt;space&gt;:&lt;space&gt;, lazy capture everything</span>
            <span class="c1">#           to look ahead (optional &lt;space&gt;):&lt;space&gt; or end of line</span>
            <span class="n">iregx_pattern</span> <span class="o">+=</span> <span class="sa">r</span><span class="s1">&#39;((?&lt;=\s\:\s).*?(?=(?:\s)?\:\s|$))?&#39;</span>
            <span class="n">iregx_pattern</span> <span class="o">+=</span> <span class="sa">r</span><span class="s1">&#39;(?:(?:\s)?\:\s)?&#39;</span>  <span class="c1"># remove (optional &lt;space&gt;):&lt;space&gt;</span>
            <span class="c1"># group 3 - look behind for &lt;space&gt;:&lt;space&gt;, lazy capture everything</span>
            <span class="c1">#           to look ahead end of line</span>
            <span class="n">iregx_pattern</span> <span class="o">+=</span> <span class="sa">r</span><span class="s1">&#39;((?&lt;=\s\:\s).*?(?=$))?$&#39;</span>
            <span class="n">iregx</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">iregx_pattern</span><span class="p">)</span>

            <span class="n">indicators</span> <span class="o">=</span> <span class="n">iregx</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">indicator</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">indicators</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">indicator_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">indicators</span><span class="o">.</span><span class="n">groups</span><span class="p">())</span>

        <span class="k">return</span> <span class="n">indicator_list</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">action</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return batch action.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_action</span>

    <span class="nd">@action</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set batch action.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_action</span> <span class="o">=</span> <span class="n">action</span>

<div class="viewcode-block" id="TcExBatch.add_group"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.TcExBatch.add_group">[docs]</a>    <span class="k">def</span> <span class="nf">add_group</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group_data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a group to Batch Job.</span>

<span class="sd">        .. code-block:: javascript</span>

<span class="sd">            {</span>
<span class="sd">                &quot;name&quot;: &quot;Example Incident&quot;,</span>
<span class="sd">                &quot;type&quot;: &quot;Incident&quot;,</span>
<span class="sd">                &quot;attribute&quot;: [{</span>
<span class="sd">                    &quot;type&quot;: &quot;Description&quot;,</span>
<span class="sd">                    &quot;displayed&quot;: false,</span>
<span class="sd">                    &quot;value&quot;: &quot;Example Description&quot;</span>
<span class="sd">                }],</span>
<span class="sd">                &quot;xid&quot;: &quot;e336e2dd-5dfb-48cd-a33a-f8809e83e904&quot;,</span>
<span class="sd">                &quot;associatedGroupXid&quot;: [</span>
<span class="sd">                    &quot;e336e2dd-5dfb-48cd-a33a-f8809e83e904:58&quot;,</span>
<span class="sd">                ],</span>
<span class="sd">                &quot;tag&quot;: [{</span>
<span class="sd">                    &quot;name&quot;: &quot;China&quot;</span>
<span class="sd">                }]</span>
<span class="sd">            }</span>

<span class="sd">        Args:</span>
<span class="sd">            group_data (dict): The full Group data including attributes, labels, tags, and</span>
<span class="sd">                associations.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">file_content</span> <span class="o">=</span> <span class="n">group_data</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;fileContent&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">file_content</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_files</span><span class="p">[</span><span class="n">group_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xid&#39;</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;fileContent&#39;</span><span class="p">:</span> <span class="n">file_content</span><span class="p">,</span>
                <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">group_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_groups_raw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">group_data</span><span class="p">)</span></div>

<div class="viewcode-block" id="TcExBatch.add_indicator"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.TcExBatch.add_indicator">[docs]</a>    <span class="k">def</span> <span class="nf">add_indicator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indicator_data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add an indicator to Batch Job.</span>

<span class="sd">        .. code-block:: javascript</span>

<span class="sd">            {</span>
<span class="sd">                &quot;type&quot;: &quot;File&quot;,</span>
<span class="sd">                &quot;rating&quot;: 5.00,</span>
<span class="sd">                &quot;confidence&quot;: 50,</span>
<span class="sd">                &quot;summary&quot;: &quot;53c3609411c83f363e051d455ade78a7 : 57a49b478310e4313c54c0fee46e4d70a73dd580 : db31cb2a748b7e0046d8c97a32a7eb4efde32a0593e5dbd58e07a3b4ae6bf3d7&quot;,</span>
<span class="sd">                &quot;associatedGroups&quot;: [</span>
<span class="sd">                    {</span>
<span class="sd">                        &quot;groupXid&quot;: &quot;e336e2dd-5dfb-48cd-a33a-f8809e83e904&quot;</span>
<span class="sd">                    }</span>
<span class="sd">                ],</span>
<span class="sd">                &quot;attribute&quot;: [{</span>
<span class="sd">                    &quot;type&quot;: &quot;Source&quot;,</span>
<span class="sd">                    &quot;displayed&quot;: true,</span>
<span class="sd">                    &quot;value&quot;: &quot;Malware Analysis provided by external AMA.&quot;</span>
<span class="sd">                }],</span>
<span class="sd">                &quot;fileOccurrence&quot;: [{</span>
<span class="sd">                    &quot;fileName&quot;: &quot;drop1.exe&quot;,</span>
<span class="sd">                    &quot;date&quot;: &quot;2017-03-03T18:00:00-06:00&quot;</span>
<span class="sd">                }],</span>
<span class="sd">                &quot;tag&quot;: [{</span>
<span class="sd">                    &quot;name&quot;: &quot;China&quot;</span>
<span class="sd">                }],</span>
<span class="sd">                &quot;xid&quot;: &quot;e336e2dd-5dfb-48cd-a33a-f8809e83e904:170139&quot;</span>
<span class="sd">            }</span>

<span class="sd">        Args:</span>
<span class="sd">            indicator_data (dict): The Full Indicator data including attributes, labels, tags,</span>
<span class="sd">                and associations.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">indicator_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Address&#39;</span><span class="p">,</span> <span class="s1">&#39;EmailAddress&#39;</span><span class="p">,</span> <span class="s1">&#39;File&#39;</span><span class="p">,</span> <span class="s1">&#39;Host&#39;</span><span class="p">,</span> <span class="s1">&#39;URL&#39;</span><span class="p">]:</span>
            <span class="c1"># for custom indicator types the valueX fields are required.</span>
            <span class="c1"># using the summary we can build the values</span>
            <span class="n">index</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_indicator_values</span><span class="p">(</span><span class="n">indicator_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;summary&#39;</span><span class="p">)):</span>
                <span class="n">indicator_data</span><span class="p">[</span><span class="s1">&#39;value</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">index</span><span class="p">)]</span> <span class="o">=</span> <span class="n">value</span>
                <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">indicator_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;File&#39;</span><span class="p">:</span>
            <span class="c1"># convert custom field name to the appropriate value for batch v2</span>
            <span class="n">size</span> <span class="o">=</span> <span class="n">indicator_data</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;size&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">indicator_data</span><span class="p">[</span><span class="s1">&#39;intValue1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">size</span>
        <span class="k">if</span> <span class="n">indicator_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;Host&#39;</span><span class="p">:</span>
            <span class="c1"># convert custom field name to the appropriate value for batch v2</span>
            <span class="n">dns_active</span> <span class="o">=</span> <span class="n">indicator_data</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;dnsActive&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">dns_active</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">indicator_data</span><span class="p">[</span><span class="s1">&#39;flag1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dns_active</span>
            <span class="n">whois_active</span> <span class="o">=</span> <span class="n">indicator_data</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;whoisActive&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">whois_active</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">indicator_data</span><span class="p">[</span><span class="s1">&#39;flag2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">whois_active</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_indicators_raw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">indicator_data</span><span class="p">)</span></div>

<div class="viewcode-block" id="TcExBatch.address"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.TcExBatch.address">[docs]</a>    <span class="k">def</span> <span class="nf">address</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ip</span><span class="p">,</span> <span class="n">rating</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">confidence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add Address data to Batch object.</span>

<span class="sd">        Args:</span>
<span class="sd">            ip (str): The value for this Indicator.</span>
<span class="sd">            rating (str, optional): The threat rating for this Indicator.</span>
<span class="sd">            confidence (str, optional): The threat confidence for this Indicator.</span>
<span class="sd">            xid (str, optional): The external id for this Indicator.</span>

<span class="sd">        Returns:</span>
<span class="sd">            obj: An instance of Address.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">indicator_obj</span> <span class="o">=</span> <span class="n">Address</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="p">,</span> <span class="n">ip</span><span class="p">,</span> <span class="n">rating</span><span class="p">,</span> <span class="n">confidence</span><span class="p">,</span> <span class="n">xid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_indicators</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">indicator_obj</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">indicator_obj</span></div>

<div class="viewcode-block" id="TcExBatch.adversary"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.TcExBatch.adversary">[docs]</a>    <span class="k">def</span> <span class="nf">adversary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add Adversary data to Batch object.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str): The name for this Group.</span>
<span class="sd">            xid (str, optional): The external id for this Group.</span>

<span class="sd">        Returns:</span>
<span class="sd">            obj: An instance of Adversary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">group_obj</span> <span class="o">=</span> <span class="n">Adversary</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">xid</span><span class="p">)</span>
        <span class="n">group_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group_lookup</span><span class="p">(</span><span class="n">xid</span><span class="p">,</span> <span class="n">group_obj</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_groups</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">group_obj</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">group_obj</span></div>

<div class="viewcode-block" id="TcExBatch.asn"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.TcExBatch.asn">[docs]</a>    <span class="k">def</span> <span class="nf">asn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">as_number</span><span class="p">,</span> <span class="n">rating</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">confidence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add ASN data to Batch object.</span>

<span class="sd">        Args:</span>
<span class="sd">            as_number (str): The value for this Indicator.</span>
<span class="sd">            rating (str, optional): The threat rating for this Indicator.</span>
<span class="sd">            confidence (str, optional): The threat confidence for this Indicator.</span>
<span class="sd">            xid (str, optional): The external id for this Indicator.</span>

<span class="sd">        Returns:</span>
<span class="sd">            obj: An instance of ASN.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">indicator_obj</span> <span class="o">=</span> <span class="n">ASN</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="p">,</span> <span class="n">as_number</span><span class="p">,</span> <span class="n">rating</span><span class="p">,</span> <span class="n">confidence</span><span class="p">,</span> <span class="n">xid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_indicators</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">indicator_obj</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">indicator_obj</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">attribute_write_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return batch attribute write type.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attribute_write_type</span>

    <span class="nd">@attribute_write_type</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">attribute_write_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attribute_write_type</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set batch attribute write type.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_attribute_write_type</span> <span class="o">=</span> <span class="n">attribute_write_type</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">auto_submit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return batch auto submit setting.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_auto_submit</span>

    <span class="nd">@auto_submit</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">auto_submit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">auto_submit</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set batch auto submit setting.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_auto_submit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">to_bool</span><span class="p">(</span><span class="n">auto_submit</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">auto_submit_limit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return batch auto submit limit.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_auto_submit_limit</span>

    <span class="nd">@auto_submit_limit</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">auto_submit_limit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">limit</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set batch auto submit limit.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_auto_submit_limit</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">limit</span><span class="p">)</span>

<div class="viewcode-block" id="TcExBatch.campaign"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.TcExBatch.campaign">[docs]</a>    <span class="k">def</span> <span class="nf">campaign</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">first_seen</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add Campaign data to Batch object.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str): The name for this Group.</span>
<span class="sd">            first_seen (str, optional): The first seen datetime expression for this Group.</span>
<span class="sd">            xid (str, optional): The external id for this Group.</span>

<span class="sd">        Returns:</span>
<span class="sd">            obj: An instance of Campaign.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">group_obj</span> <span class="o">=</span> <span class="n">Campaign</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">first_seen</span><span class="p">,</span> <span class="n">xid</span><span class="p">)</span>
        <span class="n">group_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group_lookup</span><span class="p">(</span><span class="n">xid</span><span class="p">,</span> <span class="n">group_obj</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_groups</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">group_obj</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">group_obj</span></div>

<div class="viewcode-block" id="TcExBatch.cidr"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.TcExBatch.cidr">[docs]</a>    <span class="k">def</span> <span class="nf">cidr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">block</span><span class="p">,</span> <span class="n">rating</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">confidence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add CIDR data to Batch object.</span>

<span class="sd">        Args:</span>
<span class="sd">            block (str): The value for this Indicator.</span>
<span class="sd">            rating (str, optional): The threat rating for this Indicator.</span>
<span class="sd">            confidence (str, optional): The threat confidence for this Indicator.</span>
<span class="sd">            xid (str, optional): The external id for this Indicator.</span>

<span class="sd">        Returns:</span>
<span class="sd">            obj: An instance of CIDR.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">indicator_obj</span> <span class="o">=</span> <span class="n">CIDR</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="p">,</span> <span class="n">block</span><span class="p">,</span> <span class="n">rating</span><span class="p">,</span> <span class="n">confidence</span><span class="p">,</span> <span class="n">xid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_indicators</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">indicator_obj</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">indicator_obj</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the batch data to be sent to the ThreatConnect API.&quot;&quot;&quot;</span>
        <span class="c1"># process group objects</span>
        <span class="k">for</span> <span class="n">group_data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_groups</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_groups_raw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">group_data</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">group_data</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Document&#39;</span><span class="p">,</span> <span class="s1">&#39;Report&#39;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_files</span><span class="p">[</span><span class="n">group_data</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xid&#39;</span><span class="p">)]</span> <span class="o">=</span> <span class="n">group_data</span><span class="o">.</span><span class="n">file_data</span>
        <span class="c1"># process indicator objects</span>
        <span class="k">for</span> <span class="n">indicator</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_indicators</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_indicators_raw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">indicator</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="c1"># clear data from lists</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_groups</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_indicators</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;group&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_groups_raw</span><span class="p">,</span>
            <span class="s1">&#39;indicator&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_indicators_raw</span>
        <span class="p">}</span>

<div class="viewcode-block" id="TcExBatch.document"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.TcExBatch.document">[docs]</a>    <span class="k">def</span> <span class="nf">document</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">file_name</span><span class="p">,</span> <span class="n">file_content</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">malware</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add Document data to Batch object.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str): The name for this Group.</span>
<span class="sd">            file_name (str): The name for the attached file for this Group.</span>
<span class="sd">            file_content (str;method, optional): The file contents or callback method to retrieve</span>
<span class="sd">                file content.</span>
<span class="sd">            malware (bool, default:False): If true the file is considered malware.</span>
<span class="sd">            password (bool, optional): If malware is true a password for the zip archive is</span>
<span class="sd">                required.</span>
<span class="sd">            xid (str, optional): The external id for this Group.</span>

<span class="sd">        Returns:</span>
<span class="sd">            obj: An instance of Document.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">group_obj</span> <span class="o">=</span> <span class="n">Document</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">file_name</span><span class="p">,</span> <span class="n">file_content</span><span class="p">,</span> <span class="n">malware</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">xid</span><span class="p">)</span>
        <span class="n">group_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group_lookup</span><span class="p">(</span><span class="n">xid</span><span class="p">,</span> <span class="n">group_obj</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_groups</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">group_obj</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">group_obj</span></div>

<div class="viewcode-block" id="TcExBatch.email"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.TcExBatch.email">[docs]</a>    <span class="k">def</span> <span class="nf">email</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">subject</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">to_addr</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">from_addr</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add Email data to Batch object.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str): The name for this Group.</span>
<span class="sd">            subject (str): The subject for this Email.</span>
<span class="sd">            header (str): The header for this Email.</span>
<span class="sd">            body (str): The body for this Email.</span>
<span class="sd">            to_addr (str, optional): The **to** address for this Email.</span>
<span class="sd">            from_addr (str, optional): The **from** address for this Email.</span>
<span class="sd">            xid (str, optional): The external id for this Group.</span>

<span class="sd">        Returns:</span>
<span class="sd">            obj: An instance of Email.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">group_obj</span> <span class="o">=</span> <span class="n">Email</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">subject</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">to_addr</span><span class="p">,</span> <span class="n">from_addr</span><span class="p">,</span> <span class="n">xid</span><span class="p">)</span>
        <span class="n">group_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group_lookup</span><span class="p">(</span><span class="n">xid</span><span class="p">,</span> <span class="n">group_obj</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_groups</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">group_obj</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">group_obj</span></div>

<div class="viewcode-block" id="TcExBatch.email_address"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.TcExBatch.email_address">[docs]</a>    <span class="k">def</span> <span class="nf">email_address</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">rating</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">confidence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add Email Address data to Batch object.</span>

<span class="sd">        Args:</span>
<span class="sd">            address (str): The value for this Indicator.</span>
<span class="sd">            rating (str, optional): The threat rating for this Indicator.</span>
<span class="sd">            confidence (str, optional): The threat confidence for this Indicator.</span>
<span class="sd">            xid (str, optional): The external id for this Indicator.</span>

<span class="sd">        Returns:</span>
<span class="sd">            obj: An instance of EmailAddress.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">indicator_obj</span> <span class="o">=</span> <span class="n">EmailAddress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">rating</span><span class="p">,</span> <span class="n">confidence</span><span class="p">,</span> <span class="n">xid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_indicators</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">indicator_obj</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">indicator_obj</span></div>

<div class="viewcode-block" id="TcExBatch.errors"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.TcExBatch.errors">[docs]</a>    <span class="k">def</span> <span class="nf">errors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch_id</span><span class="p">,</span> <span class="n">halt_on_error</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Retrieve Batch errors to ThreatConnect API.</span>

<span class="sd">        .. code-block:: javascript</span>

<span class="sd">            [{</span>
<span class="sd">                &quot;errorReason&quot;: &quot;Incident incident-001 has an invalid status.&quot;,</span>
<span class="sd">                &quot;errorSource&quot;: &quot;incident-001 is not valid.&quot;</span>
<span class="sd">            }, {</span>
<span class="sd">                &quot;errorReason&quot;: &quot;Incident incident-002 has an invalid status.&quot;,</span>
<span class="sd">                &quot;errorSource&quot;:&quot;incident-002 is not valid.&quot;</span>
<span class="sd">            }]</span>

<span class="sd">        Args:</span>
<span class="sd">            batch_id (str): The ID returned from the ThreatConnect API for the current batch job.</span>
<span class="sd">            halt_on_error (bool, default:True): If True any exception will raise an error.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;/v2/batch/</span><span class="si">{}</span><span class="s1">/errors&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">batch_id</span><span class="p">))</span>
            <span class="c1"># if r.status_code == 404:</span>
            <span class="c1">#     time.sleep(5)  # allow time for errors to be processed</span>
            <span class="c1">#     r = self.tcex.session.get(&#39;/v2/batch/{}/errors&#39;.format(batch_id))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Retrieve Errors for ID </span><span class="si">{}</span><span class="s1">: status code </span><span class="si">{}</span><span class="s1">, errors </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">batch_id</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">))</span>
            <span class="c1"># self.tcex.log.debug(&#39;Retrieve Errors URL {}&#39;.format(r.url))</span>
            <span class="c1"># API does not return correct content type</span>
            <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">ok</span><span class="p">:</span>
                <span class="n">errors</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
            <span class="c1"># temporarily process errors to find &quot;critical&quot; errors.</span>
            <span class="c1"># FR in core to return error codes.</span>
            <span class="k">for</span> <span class="n">error</span> <span class="ow">in</span> <span class="n">errors</span><span class="p">:</span>
                <span class="n">error_reason</span> <span class="o">=</span> <span class="n">error</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;errorReason&#39;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">error_msg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_critical_failures</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">error_msg</span><span class="p">,</span> <span class="n">error_reason</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">handle_error</span><span class="p">(</span><span class="mi">1500</span><span class="p">,</span> <span class="p">[</span><span class="n">error_reason</span><span class="p">],</span> <span class="n">halt_on_error</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">errors</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">handle_error</span><span class="p">(</span><span class="mi">560</span><span class="p">,</span> <span class="p">[</span><span class="n">e</span><span class="p">],</span> <span class="n">halt_on_error</span><span class="p">)</span></div>

<div class="viewcode-block" id="TcExBatch.event"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.TcExBatch.event">[docs]</a>    <span class="k">def</span> <span class="nf">event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">event_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add Event data to Batch object.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str): The name for this Group.</span>
<span class="sd">            event_date (str, optional): The event datetime expression for this Group.</span>
<span class="sd">            status (str, optional): The status for this Group.</span>
<span class="sd">            xid (str, optional): The external id for this Group.</span>

<span class="sd">        Returns:</span>
<span class="sd">            obj: An instance of Event.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">group_obj</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">event_date</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">xid</span><span class="p">)</span>
        <span class="n">group_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group_lookup</span><span class="p">(</span><span class="n">xid</span><span class="p">,</span> <span class="n">group_obj</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_groups</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">group_obj</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">group_obj</span></div>

<div class="viewcode-block" id="TcExBatch.file"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.TcExBatch.file">[docs]</a>    <span class="k">def</span> <span class="nf">file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">md5</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sha1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sha256</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rating</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">confidence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add File data to Batch object.</span>

<span class="sd">        .. note:: A least one file hash value must be specified.</span>

<span class="sd">        Args:</span>
<span class="sd">            md5 (str, optional): The md5 value for this Indicator.</span>
<span class="sd">            sha1 (str, optional): The sha1 value for this Indicator.</span>
<span class="sd">            sha256 (str, optional): The sha256 value for this Indicator.</span>
<span class="sd">            size (str, optional): The file size for this Indicator.</span>
<span class="sd">            rating (str, optional): The threat rating for this Indicator.</span>
<span class="sd">            confidence (str, optional): The threat confidence for this Indicator.</span>
<span class="sd">            xid (str, optional): The external id for this Indicator.</span>

<span class="sd">        Returns:</span>
<span class="sd">            obj: An instance of File.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">indicator_obj</span> <span class="o">=</span> <span class="n">File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="p">,</span> <span class="n">md5</span><span class="p">,</span> <span class="n">sha1</span><span class="p">,</span> <span class="n">sha256</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">rating</span><span class="p">,</span> <span class="n">confidence</span><span class="p">,</span> <span class="n">xid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_indicators</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">indicator_obj</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">indicator_obj</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">files</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return dictionary containing all of the file content or callbacks.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_files</span>

<div class="viewcode-block" id="TcExBatch.group"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.TcExBatch.group">[docs]</a>    <span class="k">def</span> <span class="nf">group</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group_type</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add Group data to Batch object.</span>

<span class="sd">        Args:</span>
<span class="sd">            group_type (str): The ThreatConnect define Group type.</span>
<span class="sd">            name (str): The name for this Group.</span>
<span class="sd">            xid (str, optional): The external id for this Group.</span>

<span class="sd">        Returns:</span>
<span class="sd">            obj: An instance of Group.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">group_obj</span> <span class="o">=</span> <span class="n">Group</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="p">,</span> <span class="n">group_type</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">xid</span><span class="p">)</span>
        <span class="n">group_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group_lookup</span><span class="p">(</span><span class="n">xid</span><span class="p">,</span> <span class="n">group_obj</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_groups</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">group_obj</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">group_obj</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">halt_on_error</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return batch halt on error setting.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_halt_on_error</span>

    <span class="nd">@halt_on_error</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">halt_on_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">halt_on_error</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set batch halt on error setting.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_halt_on_error</span> <span class="o">=</span> <span class="n">halt_on_error</span>

<div class="viewcode-block" id="TcExBatch.host"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.TcExBatch.host">[docs]</a>    <span class="k">def</span> <span class="nf">host</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hostname</span><span class="p">,</span> <span class="n">dns_active</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">whois_active</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">rating</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">confidence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add Email Address data to Batch object.</span>

<span class="sd">        Args:</span>
<span class="sd">            hostname (str): The value for this Indicator.</span>
<span class="sd">            dns_active (bool, default:False): If True DNS active is enabled for this indicator.</span>
<span class="sd">            whois_active (bool, default:False): If True WhoIs active is enabled for this</span>
<span class="sd">                indicator.</span>
<span class="sd">            rating (str, optional): The threat rating for this Indicator.</span>
<span class="sd">            confidence (str, optional): The threat confidence for this Indicator.</span>
<span class="sd">            xid (str, optional): The external id for this Indicator.</span>

<span class="sd">        Returns:</span>
<span class="sd">            obj: An instance of Host.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">indicator_obj</span> <span class="o">=</span> <span class="n">Host</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="p">,</span> <span class="n">hostname</span><span class="p">,</span> <span class="n">dns_active</span><span class="p">,</span> <span class="n">whois_active</span><span class="p">,</span> <span class="n">rating</span><span class="p">,</span> <span class="n">confidence</span><span class="p">,</span> <span class="n">xid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_indicators</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">indicator_obj</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">indicator_obj</span></div>

<div class="viewcode-block" id="TcExBatch.incident"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.TcExBatch.incident">[docs]</a>    <span class="k">def</span> <span class="nf">incident</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">event_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add Incident data to Batch object.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str): The name for this Group.</span>
<span class="sd">            event_date (str, optional): The event datetime expression for this Group.</span>
<span class="sd">            status (str, optional): The status for this Group.</span>
<span class="sd">            xid (str, optional): The external id for this Group.</span>

<span class="sd">        Returns:</span>
<span class="sd">            obj: An instance of Incident.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">group_obj</span> <span class="o">=</span> <span class="n">Incident</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">event_date</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">xid</span><span class="p">)</span>
        <span class="n">group_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group_lookup</span><span class="p">(</span><span class="n">xid</span><span class="p">,</span> <span class="n">group_obj</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_groups</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">group_obj</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">group_obj</span></div>

<div class="viewcode-block" id="TcExBatch.indicator"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.TcExBatch.indicator">[docs]</a>    <span class="k">def</span> <span class="nf">indicator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indicator_type</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">rating</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">confidence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add Indicator data to Batch object.</span>

<span class="sd">        Args:</span>
<span class="sd">            indicator_type (str): The ThreatConnect define Indicator type.</span>
<span class="sd">            summary (str): The value for this Indicator.</span>
<span class="sd">            rating (str, optional): The threat rating for this Indicator.</span>
<span class="sd">            confidence (str, optional): The threat confidence for this Indicator.</span>
<span class="sd">            xid (str, optional): The external id for this Indicator.</span>

<span class="sd">        Returns:</span>
<span class="sd">            obj: An instance of Indicator.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">indicator_obj</span> <span class="o">=</span> <span class="n">Indicator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="p">,</span> <span class="n">indicator_type</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">rating</span><span class="p">,</span> <span class="n">confidence</span><span class="p">,</span> <span class="n">xid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_indicators</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">indicator_obj</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">indicator_obj</span></div>

<div class="viewcode-block" id="TcExBatch.intrusion_set"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.TcExBatch.intrusion_set">[docs]</a>    <span class="k">def</span> <span class="nf">intrusion_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add Intrusion Set data to Batch object.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str): The name for this Group.</span>
<span class="sd">            xid (str, optional): The external id for this Group.</span>

<span class="sd">        Returns:</span>
<span class="sd">            obj: An instance of IntrusionSet.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">group_obj</span> <span class="o">=</span> <span class="n">IntrusionSet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">xid</span><span class="p">)</span>
        <span class="n">group_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group_lookup</span><span class="p">(</span><span class="n">xid</span><span class="p">,</span> <span class="n">group_obj</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_groups</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">group_obj</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">group_obj</span></div>

<div class="viewcode-block" id="TcExBatch.mutex"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.TcExBatch.mutex">[docs]</a>    <span class="k">def</span> <span class="nf">mutex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mutex</span><span class="p">,</span> <span class="n">rating</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">confidence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add Mutex data to Batch object.</span>

<span class="sd">        Args:</span>
<span class="sd">            mutex (str): The value for this Indicator.</span>
<span class="sd">            rating (str, optional): The threat rating for this Indicator.</span>
<span class="sd">            confidence (str, optional): The threat confidence for this Indicator.</span>
<span class="sd">            xid (str, optional): The external id for this Indicator.</span>

<span class="sd">        Returns:</span>
<span class="sd">            obj: An instance of Mutex.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">indicator_obj</span> <span class="o">=</span> <span class="n">Mutex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="p">,</span> <span class="n">mutex</span><span class="p">,</span> <span class="n">rating</span><span class="p">,</span> <span class="n">confidence</span><span class="p">,</span> <span class="n">xid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_indicators</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">indicator_obj</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">indicator_obj</span></div>

<div class="viewcode-block" id="TcExBatch.poll"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.TcExBatch.poll">[docs]</a>    <span class="k">def</span> <span class="nf">poll</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch_id</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">halt_on_error</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Poll Batch status to ThreatConnect API.</span>

<span class="sd">        .. code-block:: javascript</span>

<span class="sd">            {</span>
<span class="sd">                &quot;status&quot;: &quot;Success&quot;,</span>
<span class="sd">                &quot;data&quot;: {</span>
<span class="sd">                    &quot;batchStatus&quot;: {</span>
<span class="sd">                        &quot;id&quot;:3505,</span>
<span class="sd">                        &quot;status&quot;:&quot;Completed&quot;,</span>
<span class="sd">                        &quot;errorCount&quot;:0,</span>
<span class="sd">                        &quot;successCount&quot;:0,</span>
<span class="sd">                        &quot;unprocessCount&quot;:0</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            }</span>

<span class="sd">        Args:</span>
<span class="sd">            batch_id (str): The ID returned from the ThreatConnect API for the current batch job.</span>
<span class="sd">            interval (int, optional): Number of seconds to delay between each status request.</span>
<span class="sd">            timeout (int, optional): The number of seconds before the poll should timeout.</span>
<span class="sd">            halt_on_error (bool, default:True): If True any exception will raise an error.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: The batch status returned from the ThreatConnect API.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">interval</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">interval</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">poll_interval</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">interval</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">timeout</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">timeout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">poll_timeout</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">timeout</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">timeout</span><span class="p">)</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;includeAdditional&#39;</span><span class="p">:</span> <span class="s1">&#39;true&#39;</span>
        <span class="p">}</span>

        <span class="n">poll_time</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;/v2/batch/</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">batch_id</span><span class="p">),</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">r</span><span class="o">.</span><span class="n">ok</span> <span class="ow">or</span> <span class="s1">&#39;application/json&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;content-type&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">handle_error</span><span class="p">(</span><span class="mi">545</span><span class="p">,</span> <span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">],</span> <span class="n">halt_on_error</span><span class="p">)</span>
                    <span class="k">return</span> <span class="n">data</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;status&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="s1">&#39;Success&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">handle_error</span><span class="p">(</span><span class="mi">545</span><span class="p">,</span> <span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">],</span> <span class="n">halt_on_error</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;batchStatus&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;status&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;Completed&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Batch Status: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
                    <span class="k">return</span> <span class="n">data</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">handle_error</span><span class="p">(</span><span class="mi">540</span><span class="p">,</span> <span class="p">[</span><span class="n">e</span><span class="p">],</span> <span class="n">halt_on_error</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">error_codes</span><span class="o">.</span><span class="n">message</span><span class="p">(</span><span class="mi">540</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
            <span class="c1"># time out poll to prevent App running indefinitely</span>
            <span class="k">if</span> <span class="n">poll_time</span> <span class="o">&gt;=</span> <span class="n">timeout</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                    <span class="s1">&#39;Status check has reached the timeout value (</span><span class="si">{}</span><span class="s1"> seconds).&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">timeout</span><span class="p">))</span>
                <span class="k">return</span> <span class="n">data</span>
            <span class="n">poll_time</span> <span class="o">+=</span> <span class="n">interval</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Batch poll time: </span><span class="si">{}</span><span class="s1"> seconds&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">poll_time</span><span class="p">))</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">poll_interval</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return current poll interval value.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_poll_interval</span>

    <span class="nd">@poll_interval</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">poll_interval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interval</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the poll interval value.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_poll_interval</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">poll_timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return current poll timeout value.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_poll_timeout</span>

    <span class="nd">@poll_timeout</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">poll_timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seconds</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the poll timeout value.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_poll_timeout</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">seconds</span><span class="p">)</span>

<div class="viewcode-block" id="TcExBatch.registry_key"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.TcExBatch.registry_key">[docs]</a>    <span class="k">def</span> <span class="nf">registry_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_name</span><span class="p">,</span> <span class="n">value_name</span><span class="p">,</span> <span class="n">value_type</span><span class="p">,</span> <span class="n">rating</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">confidence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add Registry Key data to Batch object.</span>

<span class="sd">        Args:</span>
<span class="sd">            key_name (str): The key_name value for this Indicator.</span>
<span class="sd">            value_name (str): The value_name value for this Indicator.</span>
<span class="sd">            value_type (str): The value_type value for this Indicator.</span>
<span class="sd">            rating (str, optional): The threat rating for this Indicator.</span>
<span class="sd">            confidence (str, optional): The threat confidence for this Indicator.</span>
<span class="sd">            xid (str, optional): The external id for this Indicator.</span>

<span class="sd">        Returns:</span>
<span class="sd">            obj: An instance of Registry Key.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">indicator_obj</span> <span class="o">=</span> <span class="n">RegistryKey</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="p">,</span> <span class="n">key_name</span><span class="p">,</span> <span class="n">value_name</span><span class="p">,</span> <span class="n">value_type</span><span class="p">,</span> <span class="n">rating</span><span class="p">,</span> <span class="n">confidence</span><span class="p">,</span> <span class="n">xid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_indicators</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">indicator_obj</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">indicator_obj</span></div>

<div class="viewcode-block" id="TcExBatch.report"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.TcExBatch.report">[docs]</a>    <span class="k">def</span> <span class="nf">report</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">file_name</span><span class="p">,</span> <span class="n">file_content</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">publish_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add Report data to Batch object.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str): The name for this Group.</span>
<span class="sd">            file_name (str): The name for the attached file for this Group.</span>
<span class="sd">            file_content (str;method, optional): The file contents or callback method to retrieve</span>
<span class="sd">                file content.</span>
<span class="sd">            publish_date (str, optional): The publish datetime expression for this Group.</span>
<span class="sd">            xid (str, optional): The external id for this Group.</span>

<span class="sd">        Returns:</span>
<span class="sd">            obj: An instance of Report.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">group_obj</span> <span class="o">=</span> <span class="n">Report</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">file_name</span><span class="p">,</span> <span class="n">file_content</span><span class="p">,</span> <span class="n">publish_date</span><span class="p">,</span> <span class="n">xid</span><span class="p">)</span>
        <span class="n">group_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group_lookup</span><span class="p">(</span><span class="n">xid</span><span class="p">,</span> <span class="n">group_obj</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_groups</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">group_obj</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">group_obj</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">settings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return batch job settings.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_action</span><span class="p">,</span>
            <span class="c1"># not supported in v2 batch</span>
            <span class="c1"># &#39;attributeWriteType&#39;: self._attribute_write_type,</span>
            <span class="s1">&#39;attributeWriteType&#39;</span><span class="p">:</span> <span class="s1">&#39;Replace&#39;</span><span class="p">,</span>
            <span class="s1">&#39;haltOnError&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_halt_on_error</span><span class="p">,</span>
            <span class="s1">&#39;owner&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_owner</span><span class="p">,</span>
            <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;V2&#39;</span>
        <span class="p">}</span>

<div class="viewcode-block" id="TcExBatch.signature"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.TcExBatch.signature">[docs]</a>    <span class="k">def</span> <span class="nf">signature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">file_name</span><span class="p">,</span> <span class="n">file_type</span><span class="p">,</span> <span class="n">file_text</span><span class="p">,</span> <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add Signature data to Batch object.</span>

<span class="sd">        Valid file_types:</span>
<span class="sd">        + Snort </span>
<span class="sd">        + Suricata</span>
<span class="sd">        + YARA</span>
<span class="sd">        + ClamAV </span>
<span class="sd">        + OpenIOC</span>
<span class="sd">        + CybOX </span>
<span class="sd">        + Bro</span>
<span class="sd">        + Regex</span>
<span class="sd">        + SPL - Splunk  Search Processing Language</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str): The name for this Group.</span>
<span class="sd">            file_name (str): The name for the attached signature for this Group.</span>
<span class="sd">            file_type (str): The signature type for this Group.</span>
<span class="sd">            file_text (str): The signature content for this Group.</span>
<span class="sd">            xid (str, optional): The external id for this Group.</span>

<span class="sd">        Returns:</span>
<span class="sd">            obj: An instance of Signature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">group_obj</span> <span class="o">=</span> <span class="n">Signature</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">file_name</span><span class="p">,</span> <span class="n">file_type</span><span class="p">,</span> <span class="n">file_text</span><span class="p">,</span> <span class="n">xid</span><span class="p">)</span>
        <span class="n">group_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group_lookup</span><span class="p">(</span><span class="n">xid</span><span class="p">,</span> <span class="n">group_obj</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_groups</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">group_obj</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">group_obj</span></div>

<div class="viewcode-block" id="TcExBatch.submit"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.TcExBatch.submit">[docs]</a>    <span class="k">def</span> <span class="nf">submit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">poll</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">process_files</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">halt_on_error</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Submit Batch request to ThreatConnect API.</span>

<span class="sd">        By default this method will submit the job request and data and if the size of the data</span>
<span class="sd">        is below the value **synchronousBatchSaveLimit** set in System Setting it will process</span>
<span class="sd">        the request synchronously and return the batch status.  If the size of the batch is greater</span>
<span class="sd">        than the value set the batch job will be queued.</span>
<span class="sd">        Errors are not retrieve automatically and need to be enabled.</span>

<span class="sd">        If any of the submit, poll, or error methods fail the entire submit will halt at the point</span>
<span class="sd">        of failure. The behavior can be changed by setting halt_on_error to False.</span>

<span class="sd">        Each of these methods can also be called on their own for greater control of the submit</span>
<span class="sd">        process.</span>

<span class="sd">        Args:</span>
<span class="sd">            poll (bool, default:True): Poll for status.</span>
<span class="sd">            errors (bool, default:True): Retrieve any batch errors (only if poll is True).</span>
<span class="sd">            process_files (bool, default:True): Send any document or report attachments to the API.</span>
<span class="sd">            halt_on_error (bool, default:True): If True any exception will raise an error.</span>

<span class="sd">        Returns.</span>
<span class="sd">            dict: The Batch Status from the ThreatConnect API.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">batch_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">submit_create_and_upload</span><span class="p">(</span><span class="n">halt_on_error</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;batchStatus&#39;</span><span class="p">)</span>

        <span class="n">batch_id</span> <span class="o">=</span> <span class="n">batch_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">batch_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># job hit queue</span>
            <span class="k">if</span> <span class="n">poll</span><span class="p">:</span>
                <span class="c1"># poll for status</span>
                <span class="n">batch_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">poll</span><span class="p">(</span>
                    <span class="n">batch_id</span><span class="p">,</span> <span class="n">halt_on_error</span><span class="o">=</span><span class="n">halt_on_error</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;batchStatus&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">errors</span><span class="p">:</span>
                    <span class="c1"># retrieve errors</span>
                    <span class="n">error_groups</span> <span class="o">=</span> <span class="n">batch_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;errorGroupCount&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                    <span class="n">error_indicators</span> <span class="o">=</span> <span class="n">batch_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;errorIndicatorCount&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">error_groups</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">error_indicators</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;retrieving batch errors&#39;</span><span class="p">)</span>
                        <span class="n">batch_data</span><span class="p">[</span><span class="s1">&#39;errors&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">(</span><span class="n">batch_id</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># can&#39;t process files if status is unknown (polling must be enabled)</span>
                <span class="n">process_files</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">process_files</span><span class="p">:</span>
            <span class="c1"># submit file data after batch job is complete</span>
            <span class="n">batch_data</span><span class="p">[</span><span class="s1">&#39;uploadStatus&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">submit_files</span><span class="p">(</span><span class="n">halt_on_error</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">batch_data</span></div>

<div class="viewcode-block" id="TcExBatch.submit_create_and_upload"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.TcExBatch.submit_create_and_upload">[docs]</a>    <span class="k">def</span> <span class="nf">submit_create_and_upload</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">halt_on_error</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Submit Batch request to ThreatConnect API.</span>

<span class="sd">        Returns.</span>
<span class="sd">            dict: The Batch Status from the ThreatConnect API.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">files</span> <span class="o">=</span> <span class="p">(</span>
                <span class="p">(</span><span class="s1">&#39;config&#39;</span><span class="p">,</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">)),</span>
                <span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">,</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
            <span class="p">)</span>
            <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;includeAdditional&#39;</span><span class="p">:</span> <span class="s1">&#39;true&#39;</span>
            <span class="p">}</span>
            <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s1">&#39;/v2/batch/createAndUpload&#39;</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="n">files</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">handle_error</span><span class="p">(</span><span class="mi">1505</span><span class="p">,</span> <span class="p">[</span><span class="n">e</span><span class="p">],</span> <span class="n">halt_on_error</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">r</span><span class="o">.</span><span class="n">ok</span> <span class="ow">or</span> <span class="s1">&#39;application/json&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;content-type&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">handle_error</span><span class="p">(</span><span class="mi">1510</span><span class="p">,</span> <span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">],</span> <span class="n">halt_on_error</span><span class="p">)</span>
        <span class="c1"># reset raw list after submission</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_groups_raw</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_indicators_raw</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">()</span></div>

<div class="viewcode-block" id="TcExBatch.submit_files"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.TcExBatch.submit_files">[docs]</a>    <span class="k">def</span> <span class="nf">submit_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">halt_on_error</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Submit Files for Documents and Reports to ThreatConnect API.</span>

<span class="sd">        Args:</span>
<span class="sd">            halt_on_error (bool, default:True): If True any exception will raise an error.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: The upload status for each xid.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">upload_status</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">xid</span><span class="p">,</span> <span class="n">content_data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_files</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_files</span><span class="p">[</span><span class="n">xid</span><span class="p">]</span>  <span class="c1"># win or loose remove the entry</span>
            <span class="n">status</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="c1"># process the file content</span>
            <span class="n">content</span> <span class="o">=</span> <span class="n">content_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fileContent&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">upload_status</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;uploaded&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;xid&#39;</span><span class="p">:</span> <span class="n">xid</span><span class="p">})</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;File content was null for xid </span><span class="si">{}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">xid</span><span class="p">))</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="n">content</span><span class="p">):</span>
                <span class="n">content</span> <span class="o">=</span> <span class="n">content_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fileContent&#39;</span><span class="p">)(</span><span class="n">xid</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">content_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;Document&#39;</span><span class="p">:</span>
                <span class="n">api_branch</span> <span class="o">=</span> <span class="s1">&#39;documents&#39;</span>
            <span class="k">elif</span> <span class="n">content_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;Report&#39;</span><span class="p">:</span>
                <span class="n">api_branch</span> <span class="o">=</span> <span class="s1">&#39;reports&#39;</span>

            <span class="c1"># Post File</span>
            <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;/v2/groups/</span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1">/upload&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">api_branch</span><span class="p">,</span> <span class="n">xid</span><span class="p">)</span>
            <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">:</span> <span class="s1">&#39;application/octet-stream&#39;</span><span class="p">}</span>
            <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;owner&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_owner</span><span class="p">}</span>
            <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">submit_file_content</span><span class="p">(</span><span class="s1">&#39;POST&#39;</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">content</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">halt_on_error</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">401</span><span class="p">:</span>
                <span class="c1"># use PUT method if file already exists</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Received 401 status code using POST. Trying PUT to update.&#39;</span><span class="p">)</span>
                <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">submit_file_content</span><span class="p">(</span><span class="s1">&#39;PUT&#39;</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">content</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">halt_on_error</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Upload URL: </span><span class="si">{}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">content_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">),</span> <span class="n">r</span><span class="o">.</span><span class="n">url</span><span class="p">))</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">r</span><span class="o">.</span><span class="n">ok</span><span class="p">:</span>
                <span class="n">status</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">handle_error</span><span class="p">(</span><span class="mi">585</span><span class="p">,</span> <span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">],</span> <span class="n">halt_on_error</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Status </span><span class="si">{}</span><span class="s1"> for file upload with xid </span><span class="si">{}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">r</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">xid</span><span class="p">))</span>
            <span class="n">upload_status</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;uploaded&#39;</span><span class="p">:</span> <span class="n">status</span><span class="p">,</span> <span class="s1">&#39;xid&#39;</span><span class="p">:</span> <span class="n">xid</span><span class="p">})</span>
        <span class="k">return</span> <span class="n">upload_status</span></div>

<div class="viewcode-block" id="TcExBatch.submit_file_content"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.TcExBatch.submit_file_content">[docs]</a>    <span class="k">def</span> <span class="nf">submit_file_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">halt_on_error</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Submit File Content for Documents and Reports to ThreatConnect API.</span>

<span class="sd">        Args:</span>
<span class="sd">            method (str): The HTTP method for the request (POST, PUT).</span>
<span class="sd">            url (str): The URL for the request.</span>
<span class="sd">            data (str;bytes;file): The body (data) for the request.</span>
<span class="sd">            headers (dict): The headers for the request.</span>
<span class="sd">            params (dict): The query string parameters for the request.</span>
<span class="sd">            halt_on_error (bool, default:True): If True any exception will raise an error.</span>

<span class="sd">        Returns:</span>
<span class="sd">            requests.models.Response: The response from the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">r</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">handle_error</span><span class="p">(</span><span class="mi">580</span><span class="p">,</span> <span class="p">[</span><span class="n">e</span><span class="p">],</span> <span class="n">halt_on_error</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">r</span></div>

<div class="viewcode-block" id="TcExBatch.threat"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.TcExBatch.threat">[docs]</a>    <span class="k">def</span> <span class="nf">threat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add Threat data to Batch object</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str): The name for this Group.</span>
<span class="sd">            xid (str, optional): The external id for this Group.</span>

<span class="sd">        Returns:</span>
<span class="sd">            obj: An instance of Threat.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">group_obj</span> <span class="o">=</span> <span class="n">Threat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">xid</span><span class="p">)</span>
        <span class="n">group_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group_lookup</span><span class="p">(</span><span class="n">xid</span><span class="p">,</span> <span class="n">group_obj</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_groups</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">group_obj</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">group_obj</span></div>

<div class="viewcode-block" id="TcExBatch.user_agent"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.TcExBatch.user_agent">[docs]</a>    <span class="k">def</span> <span class="nf">user_agent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">rating</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">confidence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add User Agent data to Batch object</span>

<span class="sd">        Args:</span>
<span class="sd">            text (str): The value for this Indicator.</span>
<span class="sd">            rating (str, optional): The threat rating for this Indicator.</span>
<span class="sd">            confidence (str, optional): The threat confidence for this Indicator.</span>
<span class="sd">            xid (str, optional): The external id for this Indicator.</span>

<span class="sd">        Returns:</span>
<span class="sd">            obj: An instance of UserAgent.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">indicator_obj</span> <span class="o">=</span> <span class="n">UserAgent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">rating</span><span class="p">,</span> <span class="n">confidence</span><span class="p">,</span> <span class="n">xid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_indicators</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">indicator_obj</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">indicator_obj</span></div>

<div class="viewcode-block" id="TcExBatch.url"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.TcExBatch.url">[docs]</a>    <span class="k">def</span> <span class="nf">url</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">rating</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">confidence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add URL Address data to Batch object.</span>

<span class="sd">        Args:</span>
<span class="sd">            text (str): The value for this Indicator.</span>
<span class="sd">            rating (str, optional): The threat rating for this Indicator.</span>
<span class="sd">            confidence (str, optional): The threat confidence for this Indicator.</span>
<span class="sd">            xid (str, optional): The external id for this Indicator.</span>

<span class="sd">        Returns:</span>
<span class="sd">            obj: An instance of URL.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">indicator_obj</span> <span class="o">=</span> <span class="n">URL</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">rating</span><span class="p">,</span> <span class="n">confidence</span><span class="p">,</span> <span class="n">xid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_indicators</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">indicator_obj</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">indicator_obj</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">file_len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the number of current indicators.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_files</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">group_len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the number of current groups.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_groups</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_groups_raw</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">indicator_len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the number of current indicators.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_indicators</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_indicators_raw</span><span class="p">)</span>

<div class="viewcode-block" id="TcExBatch.__len__"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.TcExBatch.__len__">[docs]</a>    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the number of groups and indicators.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">group_len</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">indicator_len</span></div>

<div class="viewcode-block" id="TcExBatch.__str__"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.TcExBatch.__str__">[docs]</a>    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send the batch request to ThreatConnect.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div></div>


<span class="c1">#</span>
<span class="c1"># Groups</span>
<span class="c1">#</span>


<div class="viewcode-block" id="Group"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.Group">[docs]</a><span class="k">class</span> <span class="nc">Group</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;ThreatConnect Batch Group Object&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tcex</span><span class="p">,</span> <span class="n">group_type</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize Class Properties.</span>

<span class="sd">        Args:</span>
<span class="sd">            tcex (TcEx Instance): Instance of TcEx</span>
<span class="sd">            group_type (str): The ThreatConnect define Group type.</span>
<span class="sd">            name (str): The name for this Group.</span>
<span class="sd">            xid (str, optional): The external id for this Group.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span> <span class="o">=</span> <span class="n">tcex</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">=</span> <span class="n">group_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">group_type</span><span class="p">,</span>
            <span class="s1">&#39;xid&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xid</span><span class="p">(</span><span class="n">xid</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_attributes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tags</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># processed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_processed</span> <span class="o">=</span> <span class="kc">False</span>

<div class="viewcode-block" id="Group._xid"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.Group._xid">[docs]</a>    <span class="k">def</span> <span class="nf">_xid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a valid xid.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">xid</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">or</span> <span class="n">xid</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># generate a reproducible value for xid</span>
            <span class="n">xid_string</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">-</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="p">)</span>
            <span class="n">hash_object</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="n">xid_string</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
            <span class="n">xid</span> <span class="o">=</span> <span class="n">hash_object</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">xid</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="c1"># generate a random value for xid</span>
            <span class="n">xid</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())</span>

        <span class="k">return</span> <span class="n">xid</span></div>

<div class="viewcode-block" id="Group.add_key_value"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.Group.add_key_value">[docs]</a>    <span class="k">def</span> <span class="nf">add_key_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add custom field to Group object.</span>

<span class="sd">        .. note:: The key must be the exact name required by the batch schema.</span>

<span class="sd">        Example::</span>

<span class="sd">            document = tcex.batch.group(&#39;Document&#39;, &#39;My Document&#39;)</span>
<span class="sd">            document.add_key_value(&#39;fileName&#39;, &#39;something.pdf&#39;)</span>

<span class="sd">        Args:</span>
<span class="sd">            key (str): The field key to add to the JSON batch data.</span>
<span class="sd">            value (str): The field value to add to the JSON batch data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span></div>

<div class="viewcode-block" id="Group.association"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.Group.association">[docs]</a>    <span class="k">def</span> <span class="nf">association</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group_xid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add association using xid value.</span>

<span class="sd">        Args:</span>
<span class="sd">            group_xid (str): The external id of the Group to associate.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;associatedGroupXid&#39;</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">group_xid</span><span class="p">)</span></div>

<div class="viewcode-block" id="Group.attribute"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.Group.attribute">[docs]</a>    <span class="k">def</span> <span class="nf">attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr_type</span><span class="p">,</span> <span class="n">attr_value</span><span class="p">,</span> <span class="n">displayed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">formatter</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return instance of Attribute</span>

<span class="sd">        Args:</span>
<span class="sd">            attr_type (str): The ThreatConnect defined attribute type.</span>
<span class="sd">            attr_value (str): The value for this attribute.</span>
<span class="sd">            displayed (bool, default:false): If True the supported attribute will be marked for</span>
<span class="sd">                display.</span>
<span class="sd">            source (str, optional): The source value for this attribute.</span>
<span class="sd">            formatter (method, optional): A method that take a single attribute value and return a</span>
<span class="sd">                single formatted value.</span>

<span class="sd">        Returns:</span>
<span class="sd">            obj: An instance of Attribute.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">attr</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="p">,</span> <span class="n">attr_type</span><span class="p">,</span> <span class="n">attr_value</span><span class="p">,</span> <span class="n">displayed</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">formatter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_attributes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">attr</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return Group data.&quot;&quot;&quot;</span>
        <span class="c1"># add attributes</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attributes</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="p">[</span><span class="s1">&#39;attribute&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attributes</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">attr</span><span class="o">.</span><span class="n">valid</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="p">[</span><span class="s1">&#39;attribute&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attr</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="c1"># add security labels</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="p">[</span><span class="s1">&#39;securityLabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="p">[</span><span class="s1">&#39;securityLabel&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="c1"># add tags</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tags</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="p">[</span><span class="s1">&#39;tag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tags</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">tag</span><span class="o">.</span><span class="n">valid</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="p">[</span><span class="s1">&#39;tag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tag</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return Group name.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">processed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return processed value.</span>

<span class="sd">        .. note:: Processed value indicates that a group with this xid has already been processed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_processed</span>

    <span class="nd">@processed</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">processed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">processed</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set processed.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_processed</span> <span class="o">=</span> <span class="n">processed</span>

<div class="viewcode-block" id="Group.security_label"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.Group.security_label">[docs]</a>    <span class="k">def</span> <span class="nf">security_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return instance of SecurityLabel.</span>

<span class="sd">        .. note:: The provided security label will be create if it doesn&#39;t exist. If the security</span>
<span class="sd">            label already exists nothing will be changed.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str): The value for this security label.</span>
<span class="sd">            description (str): A description for this security label.</span>
<span class="sd">            color (str): A color (hex value) for this security label.</span>

<span class="sd">        Returns:</span>
<span class="sd">            obj: An instance of SecurityLabel.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">SecurityLabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">label</span></div>

<div class="viewcode-block" id="Group.tag"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.Group.tag">[docs]</a>    <span class="k">def</span> <span class="nf">tag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">formatter</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return instance of Tag.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str): The value for this tag.</span>
<span class="sd">            formatter (method, optional): A method that take a tag value and returns a</span>
<span class="sd">                formatted tag.</span>

<span class="sd">        Returns:</span>
<span class="sd">            obj: An instance of Tag.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tag</span> <span class="o">=</span> <span class="n">Tag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">formatter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">tag</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">xid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return Group xid.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xid&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="Group.__str__"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.Group.__str__">[docs]</a>    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return string represtentation of object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Adversary"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.Adversary">[docs]</a><span class="k">class</span> <span class="nc">Adversary</span><span class="p">(</span><span class="n">Group</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;ThreatConnect Batch Adversary Object&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tcex</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize Class Properties.</span>

<span class="sd">        Args:</span>
<span class="sd">            tcex (TcEx Instance): Instance of TcEx</span>
<span class="sd">            name (str): The name for this Group.</span>
<span class="sd">            xid (str, optional): The external id for this Group.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Adversary</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">tcex</span><span class="p">,</span> <span class="s1">&#39;Adversary&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">xid</span><span class="p">)</span></div>


<div class="viewcode-block" id="Campaign"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.Campaign">[docs]</a><span class="k">class</span> <span class="nc">Campaign</span><span class="p">(</span><span class="n">Group</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;ThreatConnect Batch Campaign Object&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tcex</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">first_seen</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize Class Properties.</span>

<span class="sd">        Args:</span>
<span class="sd">            tcex (obj): An instance of TcEx object.</span>
<span class="sd">            name (str): The name for this Group.</span>
<span class="sd">            first_seen (str, optional): The first see datetime expression for this Group.</span>
<span class="sd">            xid (str, optional): The external id for this Group.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Campaign</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">tcex</span><span class="p">,</span> <span class="s1">&#39;Campaign&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">xid</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">first_seen</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="p">[</span><span class="s1">&#39;firstSeen&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">format_datetime</span><span class="p">(</span>
                <span class="n">first_seen</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">T%H:%M:%SZ&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">first_seen</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return Document first seen.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;firstSeen&#39;</span><span class="p">)</span>

    <span class="nd">@first_seen</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">first_seen</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">first_seen</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set Document first seen.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="p">[</span><span class="s1">&#39;firstSeen&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">format_datetime</span><span class="p">(</span>
            <span class="n">first_seen</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">T%H:%M:%SZ&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Document"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.Document">[docs]</a><span class="k">class</span> <span class="nc">Document</span><span class="p">(</span><span class="n">Group</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;ThreatConnect Batch Document Object&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tcex</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">file_name</span><span class="p">,</span> <span class="n">file_content</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">malware</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize Class Properties.</span>

<span class="sd">        Args:</span>
<span class="sd">            tcex (TcEx Instance): Instance of TcEx</span>
<span class="sd">            name (str): The name for this Group.</span>
<span class="sd">            file_name (str): The name for the attached file for this Group.</span>
<span class="sd">            file_content (str;method, optional): The file contents or callback method to retrieve</span>
<span class="sd">                file content.</span>
<span class="sd">            malware (bool, default:False): If true the file is considered malware.</span>
<span class="sd">            password (bool, optional): If malware is true a password for the zip archive is</span>
<span class="sd">                required.</span>
<span class="sd">            xid (str, optional): The external id for this Group.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Document</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">tcex</span><span class="p">,</span> <span class="s1">&#39;Document&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">xid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="p">[</span><span class="s1">&#39;fileName&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">file_name</span>
        <span class="c1"># file data/content to upload</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_file_data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;fileContent&#39;</span><span class="p">:</span> <span class="n">file_content</span><span class="p">,</span>
            <span class="s1">&#39;fileName&#39;</span><span class="p">:</span> <span class="n">file_name</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">malware</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="p">[</span><span class="s1">&#39;malware&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">malware</span>
        <span class="k">if</span> <span class="n">password</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">password</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">file_content</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return Group files.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fileContent&#39;</span><span class="p">)</span>

    <span class="nd">@file_content</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">file_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_content</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set Document or Report file data.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_file_data</span><span class="p">[</span><span class="s1">&#39;fileContent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">file_content</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">file_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return Group files.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_data</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">malware</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return Document malware.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;malware&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

    <span class="nd">@malware</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">malware</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">malware</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set Document malware.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="p">[</span><span class="s1">&#39;malware&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">malware</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">password</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return Document password.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;password&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

    <span class="nd">@password</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">password</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">password</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set Document password.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">password</span></div>


<div class="viewcode-block" id="Email"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.Email">[docs]</a><span class="k">class</span> <span class="nc">Email</span><span class="p">(</span><span class="n">Group</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;ThreatConnect Batch Email Object&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tcex</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">subject</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">to_addr</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">from_addr</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize Class Properties.</span>

<span class="sd">        Args:</span>
<span class="sd">            tcex (TcEx Instance): Instance of TcEx</span>
<span class="sd">            name (str): The name for this Group.</span>
<span class="sd">            subject (str): The subject for this Email.</span>
<span class="sd">            header (str): The header for this Email.</span>
<span class="sd">            body (str): The body for this Email.</span>
<span class="sd">            to_addr (str, optional): The **to** address for this Email.</span>
<span class="sd">            from_addr (str, optional): The **from** address for this Email.</span>
<span class="sd">            xid (str, optional): The external id for this Group.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Email</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">tcex</span><span class="p">,</span> <span class="s1">&#39;Email&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">xid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="p">[</span><span class="s1">&#39;subject&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">subject</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="p">[</span><span class="s1">&#39;header&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">header</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="p">[</span><span class="s1">&#39;body&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">body</span>
        <span class="k">if</span> <span class="n">to_addr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="p">[</span><span class="s1">&#39;to&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">to_addr</span>
        <span class="k">if</span> <span class="n">from_addr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="p">[</span><span class="s1">&#39;from&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">from_addr</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">from_addr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return Email to.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;to&#39;</span><span class="p">)</span>

    <span class="nd">@from_addr</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">from_addr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">from_addr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set Email from.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="p">[</span><span class="s1">&#39;from&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">from_addr</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">to_addr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return Email to.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;to&#39;</span><span class="p">)</span>

    <span class="nd">@to_addr</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">to_addr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">to_addr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set Email to.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="p">[</span><span class="s1">&#39;to&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">to_addr</span></div>


<div class="viewcode-block" id="Event"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.Event">[docs]</a><span class="k">class</span> <span class="nc">Event</span><span class="p">(</span><span class="n">Group</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;ThreatConnect Batch Event Object&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tcex</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">event_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize Class Properties.</span>

<span class="sd">        Valid Values:</span>
<span class="sd">        + Escalated</span>
<span class="sd">        + False Positive</span>
<span class="sd">        + Needs Review</span>
<span class="sd">        + No Further Action</span>

<span class="sd">        Args:</span>
<span class="sd">            tcex (TcEx Instance): Instance of TcEx</span>
<span class="sd">            name (str): The name for this Group.</span>
<span class="sd">            event_date (str, optional): The event datetime expression for this Group.</span>
<span class="sd">            status (str, optional): The status for this Group.</span>
<span class="sd">            xid (str, optional): The external id for this Group.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Event</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">tcex</span><span class="p">,</span> <span class="s1">&#39;Event&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">xid</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">event_date</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="p">[</span><span class="s1">&#39;eventDate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">format_datetime</span><span class="p">(</span>
                <span class="n">event_date</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">T%H:%M:%SZ&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">status</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">status</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">event_date</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the Events &quot;event date&quot; value.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;firstSeen&#39;</span><span class="p">)</span>

    <span class="nd">@event_date</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">event_date</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event_date</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the Events &quot;event date&quot; value.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="p">[</span><span class="s1">&#39;eventDate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">format_datetime</span><span class="p">(</span>
            <span class="n">event_date</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">T%H:%M:%SZ&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">status</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the Events status value.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;status&#39;</span><span class="p">)</span>

    <span class="nd">@status</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">status</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the Events status value.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">status</span></div>


<div class="viewcode-block" id="Incident"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.Incident">[docs]</a><span class="k">class</span> <span class="nc">Incident</span><span class="p">(</span><span class="n">Group</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;ThreatConnect Batch Incident Object&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tcex</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">event_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize Class Properties.</span>

<span class="sd">        Valid Values:</span>
<span class="sd">        + Closed</span>
<span class="sd">        + Containment Achieved</span>
<span class="sd">        + Deleted</span>
<span class="sd">        + Incident Reported</span>
<span class="sd">        + Open</span>
<span class="sd">        + New</span>
<span class="sd">        + Rejected</span>
<span class="sd">        + Restoration Achieved</span>
<span class="sd">        + Stalled</span>

<span class="sd">        Args:</span>
<span class="sd">            tcex (obj): An instance of TcEx object.</span>
<span class="sd">            name (str): The name for this Group.</span>
<span class="sd">            event_date (str, optional): The event datetime expression for this Group.</span>
<span class="sd">            status (str, optional): The status for this Group.</span>
<span class="sd">            xid (str, optional): The external id for this Group.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Incident</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">tcex</span><span class="p">,</span> <span class="s1">&#39;Incident&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">xid</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">event_date</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="p">[</span><span class="s1">&#39;eventDate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">format_datetime</span><span class="p">(</span>
                <span class="n">event_date</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">T%H:%M:%SZ&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">status</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">status</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">event_date</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return Incident event date.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;eventDate&#39;</span><span class="p">)</span>

    <span class="nd">@event_date</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">event_date</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event_date</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set Incident event_date.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="p">[</span><span class="s1">&#39;eventDate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">format_datetime</span><span class="p">(</span>
            <span class="n">event_date</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">T%H:%M:%SZ&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">status</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return Incident status.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;status&#39;</span><span class="p">)</span>

    <span class="nd">@status</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">status</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set Incident status.</span>

<span class="sd">        Valid Values:</span>
<span class="sd">        + New</span>
<span class="sd">        + Open</span>
<span class="sd">        + Stalled</span>
<span class="sd">        + Containment Achieved</span>
<span class="sd">        + Restoration Achieved</span>
<span class="sd">        + Incident Reported</span>
<span class="sd">        + Closed</span>
<span class="sd">        + Rejected</span>
<span class="sd">        + Deleted</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">status</span></div>


<div class="viewcode-block" id="IntrusionSet"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.IntrusionSet">[docs]</a><span class="k">class</span> <span class="nc">IntrusionSet</span><span class="p">(</span><span class="n">Group</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;ThreatConnect Batch Adversary Object&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tcex</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize Class Properties.</span>

<span class="sd">        Args:</span>
<span class="sd">            tcex (obj): An instance of TcEx object.</span>
<span class="sd">            name (str): The name for this Group.</span>
<span class="sd">            xid (str, optional): The external id for this Group.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">IntrusionSet</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">tcex</span><span class="p">,</span> <span class="s1">&#39;Intrusion Set&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">xid</span><span class="p">)</span></div>


<div class="viewcode-block" id="Report"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.Report">[docs]</a><span class="k">class</span> <span class="nc">Report</span><span class="p">(</span><span class="n">Group</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;ThreatConnect Batch Report Object&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tcex</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">file_name</span><span class="p">,</span> <span class="n">file_content</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">publish_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize Class Properties.</span>

<span class="sd">        Args:</span>
<span class="sd">            tcex (TcEx Instance): Instance of TcEx</span>
<span class="sd">            name (str): The name for this Group.</span>
<span class="sd">            file_name (str): The name for the attached file for this Group.</span>
<span class="sd">            file_content (str;method, optional): The file contents or callback method to retrieve</span>
<span class="sd">                file content.</span>
<span class="sd">            publish_date (str, optional): The publish datetime expression for this Group.</span>
<span class="sd">            xid (str, optional): The external id for this Group.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Report</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">tcex</span><span class="p">,</span> <span class="s1">&#39;Report&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">xid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="p">[</span><span class="s1">&#39;fileName&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">file_name</span>
        <span class="c1"># file data/content to upload</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_file_data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;fileContent&#39;</span><span class="p">:</span> <span class="n">file_content</span><span class="p">,</span>
            <span class="s1">&#39;fileName&#39;</span><span class="p">:</span> <span class="n">file_name</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_file_data</span><span class="p">[</span><span class="s1">&#39;fileContent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">file_content</span>
        <span class="k">if</span> <span class="n">publish_date</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="p">[</span><span class="s1">&#39;publishDate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">format_datetime</span><span class="p">(</span>
                <span class="n">publish_date</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">T%H:%M:%SZ&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">file_content</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return Group files.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fileContent&#39;</span><span class="p">)</span>

    <span class="nd">@file_content</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">file_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_content</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set Document or Report file data.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_file_data</span><span class="p">[</span><span class="s1">&#39;fileContent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">file_content</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">file_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return Group files.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_data</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">publish_date</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return Report publish date.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;publishDate&#39;</span><span class="p">)</span>

    <span class="nd">@publish_date</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">publish_date</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">publish_date</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set Report publish date&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="p">[</span><span class="s1">&#39;publishDate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">format_datetime</span><span class="p">(</span>
            <span class="n">publish_date</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">T%H:%M:%SZ&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Signature"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.Signature">[docs]</a><span class="k">class</span> <span class="nc">Signature</span><span class="p">(</span><span class="n">Group</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;ThreatConnect Batch Signature Object&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tcex</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">file_name</span><span class="p">,</span> <span class="n">file_type</span><span class="p">,</span> <span class="n">file_text</span><span class="p">,</span> <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize Class Properties.</span>

<span class="sd">        Valid file_types:</span>
<span class="sd">        + Snort </span>
<span class="sd">        + Suricata</span>
<span class="sd">        + YARA</span>
<span class="sd">        + ClamAV </span>
<span class="sd">        + OpenIOC</span>
<span class="sd">        + CybOX </span>
<span class="sd">        + Bro</span>
<span class="sd">        + Regex</span>
<span class="sd">        + SPL - Splunk  Search Processing Language</span>

<span class="sd">        Args:</span>
<span class="sd">            tcex (TcEx Instance): Instance of TcEx</span>
<span class="sd">            name (str): The name for this Group.</span>
<span class="sd">            file_name (str): The name for the attached signature for this Group.</span>
<span class="sd">            file_type (str): The signature type for this Group.</span>
<span class="sd">            file_text (str): The signature content for this Group.</span>
<span class="sd">            xid (str, optional): The external id for this Group.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Signature</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">tcex</span><span class="p">,</span> <span class="s1">&#39;Signature&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">xid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="p">[</span><span class="s1">&#39;fileName&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">file_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="p">[</span><span class="s1">&#39;fileType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">file_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_group_data</span><span class="p">[</span><span class="s1">&#39;fileText&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">file_text</span></div>


<div class="viewcode-block" id="Threat"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.Threat">[docs]</a><span class="k">class</span> <span class="nc">Threat</span><span class="p">(</span><span class="n">Group</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;ThreatConnect Batch Threat Object&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tcex</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize Class Properties.</span>

<span class="sd">        Args:</span>
<span class="sd">            tcex (obj): An instance of TcEx object.</span>
<span class="sd">            name (str): The name for this Group.</span>
<span class="sd">            xid (str, optional): The external id for this Group.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Threat</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">tcex</span><span class="p">,</span> <span class="s1">&#39;Threat&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">xid</span><span class="p">)</span></div>


<span class="c1">#</span>
<span class="c1"># Indicators</span>
<span class="c1">#</span>


<div class="viewcode-block" id="Indicator"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.Indicator">[docs]</a><span class="k">class</span> <span class="nc">Indicator</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;ThreatConnect Batch Indicator Object&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tcex</span><span class="p">,</span> <span class="n">indicator_type</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">rating</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">confidence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize Class Properties.</span>

<span class="sd">        Args:</span>
<span class="sd">            tcex (obj): An instance of TcEx object.</span>
<span class="sd">            indicator_type (str): The ThreatConnect define Indicator type.</span>
<span class="sd">            summary (str): The value for this Indicator.</span>
<span class="sd">            rating (str, optional): The threat rating for this Indicator.</span>
<span class="sd">            confidence (str, optional): The threat confidence for this Indicator.</span>
<span class="sd">            xid (str, optional): The external id for this Indicator.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span> <span class="o">=</span> <span class="n">tcex</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_summary</span> <span class="o">=</span> <span class="n">summary</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">=</span> <span class="n">indicator_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_indicator_data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;summary&#39;</span><span class="p">:</span> <span class="n">summary</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">indicator_type</span><span class="p">,</span>
            <span class="s1">&#39;xid&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xid</span><span class="p">(</span><span class="n">xid</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">confidence</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_indicator_data</span><span class="p">[</span><span class="s1">&#39;confidence&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">confidence</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">rating</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_indicator_data</span><span class="p">[</span><span class="s1">&#39;rating&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rating</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_attributes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_file_actions</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_occurrences</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tags</span> <span class="o">=</span> <span class="p">[]</span>

<div class="viewcode-block" id="Indicator._xid"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.Indicator._xid">[docs]</a>    <span class="k">def</span> <span class="nf">_xid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a valid xid.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">xid</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">or</span> <span class="n">xid</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># generate a reproducible value for xid</span>
            <span class="n">xid_string</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">-</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_summary</span><span class="p">)</span>
            <span class="n">hash_object</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="n">xid_string</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
            <span class="n">xid</span> <span class="o">=</span> <span class="n">hash_object</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">xid</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="c1"># generate a random value for xid</span>
            <span class="n">xid</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())</span>

        <span class="k">return</span> <span class="n">xid</span></div>

<div class="viewcode-block" id="Indicator.add_key_value"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.Indicator.add_key_value">[docs]</a>    <span class="k">def</span> <span class="nf">add_key_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add custom field to Indicator object.</span>

<span class="sd">        .. note:: The key must be the exact name required by the batch schema.</span>

<span class="sd">        Example::</span>

<span class="sd">            file_hash = tcex.batch.file(&#39;File&#39;, &#39;1d878cdc391461e392678ba3fc9f6f32&#39;)</span>
<span class="sd">            file_hash.add_key_value(&#39;size&#39;, &#39;1024&#39;)</span>

<span class="sd">        Args:</span>
<span class="sd">            key (str): The field key to add to the JSON batch data.</span>
<span class="sd">            value (str): The field value to add to the JSON batch data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_indicator_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;File&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span>
                <span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;intValue1&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_indicator_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;Host&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;dnsActive&#39;</span><span class="p">:</span>
                <span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;flag1&#39;</span>
            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;whoisActive&#39;</span><span class="p">:</span>
                <span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;flag2&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_indicator_data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span></div>

<div class="viewcode-block" id="Indicator.build_summary"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.Indicator.build_summary">[docs]</a>    <span class="k">def</span> <span class="nf">build_summary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">val2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">val3</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Build the Indicator summary using available values.&quot;&quot;&quot;</span>
        <span class="n">summary</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">val1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">summary</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">val2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">summary</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">val3</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">summary</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val3</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">summary</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">handle_error</span><span class="p">(</span><span class="mi">590</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39; : &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">summary</span><span class="p">)</span></div>

<div class="viewcode-block" id="Indicator.association"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.Indicator.association">[docs]</a>    <span class="k">def</span> <span class="nf">association</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group_xid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add association using xid value.</span>

<span class="sd">        Args:</span>
<span class="sd">            group_xid (str): The external id of the Group to associate.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">association</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;groupXid&#39;</span><span class="p">:</span> <span class="n">group_xid</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_indicator_data</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;associatedGroups&#39;</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">association</span><span class="p">)</span></div>

<div class="viewcode-block" id="Indicator.attribute"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.Indicator.attribute">[docs]</a>    <span class="k">def</span> <span class="nf">attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr_type</span><span class="p">,</span> <span class="n">attr_value</span><span class="p">,</span> <span class="n">displayed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">formatter</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return instance of Attribute</span>

<span class="sd">        Args:</span>
<span class="sd">            attr_type (str): The ThreatConnect defined attribute type.</span>
<span class="sd">            attr_value (str): The value for this attribute.</span>
<span class="sd">            displayed (bool, default:false): If True the supported attribute will be marked for</span>
<span class="sd">                display.</span>
<span class="sd">            source (str, optional): The source value for this attribute.</span>
<span class="sd">            formatter (method, optional): A method that take a single attribute value and return a</span>
<span class="sd">                single formatted value.</span>

<span class="sd">        Returns:</span>
<span class="sd">            obj: An instance of Attribute.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">attr</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="p">,</span> <span class="n">attr_type</span><span class="p">,</span> <span class="n">attr_value</span><span class="p">,</span> <span class="n">displayed</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">formatter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_attributes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">attr</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">confidence</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return Indicator confidence.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_indicator_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;confidence&#39;</span><span class="p">)</span>

    <span class="nd">@confidence</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">confidence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">confidence</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set Indicator confidence.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_indicator_data</span><span class="p">[</span><span class="s1">&#39;confidence&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">confidence</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return Indicator data.&quot;&quot;&quot;</span>
        <span class="c1"># add attributes</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attributes</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_indicator_data</span><span class="p">[</span><span class="s1">&#39;attribute&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attributes</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">attr</span><span class="o">.</span><span class="n">valid</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_indicator_data</span><span class="p">[</span><span class="s1">&#39;attribute&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attr</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="c1"># add file actions</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_actions</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_indicator_data</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;fileAction&#39;</span><span class="p">,</span> <span class="p">{})</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_indicator_data</span><span class="p">[</span><span class="s1">&#39;fileAction&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;children&#39;</span><span class="p">,</span> <span class="p">[])</span>
            <span class="k">for</span> <span class="n">action</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_actions</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_indicator_data</span><span class="p">[</span><span class="s1">&#39;fileAction&#39;</span><span class="p">][</span><span class="s1">&#39;children&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">action</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="c1"># add file occurrences</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_occurrences</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_indicator_data</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;fileOccurrence&#39;</span><span class="p">,</span> <span class="p">[])</span>
            <span class="k">for</span> <span class="n">occurrence</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_occurrences</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_indicator_data</span><span class="p">[</span><span class="s1">&#39;fileOccurrence&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">occurrence</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="c1"># add security labels</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_indicator_data</span><span class="p">[</span><span class="s1">&#39;securityLabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_indicator_data</span><span class="p">[</span><span class="s1">&#39;securityLabel&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="c1"># add tags</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tags</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_indicator_data</span><span class="p">[</span><span class="s1">&#39;tag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tags</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">tag</span><span class="o">.</span><span class="n">valid</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_indicator_data</span><span class="p">[</span><span class="s1">&#39;tag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tag</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_indicator_data</span>

<div class="viewcode-block" id="Indicator.occurrence"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.Indicator.occurrence">[docs]</a>    <span class="k">def</span> <span class="nf">occurrence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">date</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a file Occurrence.</span>

<span class="sd">        Args:</span>
<span class="sd">            file_name (str, optional): The file name for this occurrence.</span>
<span class="sd">            path (str, optional): The file path for this occurrence.</span>
<span class="sd">            date (str, optional): The datetime expression for this occurrence.</span>

<span class="sd">        Returns:</span>
<span class="sd">            obj: An instance of Occurrence.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_indicator_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="s1">&#39;File&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">handle_error</span><span class="p">(</span><span class="mi">520</span><span class="p">,</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_indicator_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">)],</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">occurrence_obj</span> <span class="o">=</span> <span class="n">FileOccurrence</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="p">,</span> <span class="n">file_name</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">date</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_occurrences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">occurrence_obj</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">occurrence_obj</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">private_flag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return Indicator private flag.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_indicator_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;privateFlag&#39;</span><span class="p">)</span>

    <span class="nd">@private_flag</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">private_flag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">private_flag</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set Indicator private flag.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_indicator_data</span><span class="p">[</span><span class="s1">&#39;privateFlag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">to_bool</span><span class="p">(</span><span class="n">private_flag</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">rating</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return Indicator rating.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_indicator_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;rating&#39;</span><span class="p">)</span>

    <span class="nd">@rating</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">rating</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rating</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set Indicator rating.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_indicator_data</span><span class="p">[</span><span class="s1">&#39;rating&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rating</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return Indicator summary.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_indicator_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;summary&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="Indicator.security_label"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.Indicator.security_label">[docs]</a>    <span class="k">def</span> <span class="nf">security_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return instance of SecurityLabel.</span>

<span class="sd">        .. note:: The provided security label will be create if it doesn&#39;t exist. If the security</span>
<span class="sd">            label already exists nothing will be changed.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str): The value for this security label.</span>
<span class="sd">            description (str): A description for this security label.</span>
<span class="sd">            color (str): A color (hex value) for this security label.</span>

<span class="sd">        Returns:</span>
<span class="sd">            obj: An instance of SecurityLabel.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">SecurityLabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">label</span></div>

<div class="viewcode-block" id="Indicator.tag"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.Indicator.tag">[docs]</a>    <span class="k">def</span> <span class="nf">tag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">formatter</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return instance of Tag.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str): The value for this tag.</span>
<span class="sd">            formatter (method, optional): A method that take a tag value and returns a</span>
<span class="sd">                formatted tag.</span>

<span class="sd">        Returns:</span>
<span class="sd">            obj: An instance of Tag.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tag</span> <span class="o">=</span> <span class="n">Tag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">formatter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">tag</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">xid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return Group xid.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_indicator_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xid&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="Indicator.__str__"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.Indicator.__str__">[docs]</a>    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return string represtentation of object&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Address"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.Address">[docs]</a><span class="k">class</span> <span class="nc">Address</span><span class="p">(</span><span class="n">Indicator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;ThreatConnect Batch Address Object&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tcex</span><span class="p">,</span> <span class="n">ip</span><span class="p">,</span> <span class="n">rating</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">confidence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize Class Properties.</span>

<span class="sd">        Args:</span>
<span class="sd">            tcex (obj): An instance of TcEx object.</span>
<span class="sd">            ip (str): The value for this Indicator.</span>
<span class="sd">            rating (str, optional): The threat rating for this Indicator.</span>
<span class="sd">            confidence (str, optional): The threat confidence for this Indicator.</span>
<span class="sd">            xid (str, optional): The external id for this Indicator.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Address</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">tcex</span><span class="p">,</span> <span class="s1">&#39;Address&#39;</span><span class="p">,</span> <span class="n">ip</span><span class="p">,</span> <span class="n">rating</span><span class="p">,</span> <span class="n">confidence</span><span class="p">,</span> <span class="n">xid</span><span class="p">)</span></div>


<div class="viewcode-block" id="ASN"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.ASN">[docs]</a><span class="k">class</span> <span class="nc">ASN</span><span class="p">(</span><span class="n">Indicator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;ThreatConnect Batch ASN Object.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tcex</span><span class="p">,</span> <span class="n">as_number</span><span class="p">,</span> <span class="n">rating</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">confidence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize Class Properties.</span>

<span class="sd">        Args:</span>
<span class="sd">            tcex (obj): An instance of TcEx object.</span>
<span class="sd">            as_number (str): The value for this Indicator.</span>
<span class="sd">            rating (str, optional): The threat rating for this Indicator.</span>
<span class="sd">            confidence (str, optional): The threat confidence for this Indicator.</span>
<span class="sd">            xid (str, optional): The external id for this Indicator.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ASN</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">tcex</span><span class="p">,</span> <span class="s1">&#39;ASN&#39;</span><span class="p">,</span> <span class="n">as_number</span><span class="p">,</span> <span class="n">rating</span><span class="p">,</span> <span class="n">confidence</span><span class="p">,</span> <span class="n">xid</span><span class="p">)</span></div>


<div class="viewcode-block" id="CIDR"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.CIDR">[docs]</a><span class="k">class</span> <span class="nc">CIDR</span><span class="p">(</span><span class="n">Indicator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;ThreatConnect Batch CIDR Object&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tcex</span><span class="p">,</span> <span class="n">block</span><span class="p">,</span> <span class="n">rating</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">confidence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize Class Properties.</span>

<span class="sd">        Args:</span>
<span class="sd">            tcex (obj): An instance of TcEx object.</span>
<span class="sd">            block (str): The value for this Indicator.</span>
<span class="sd">            rating (str, optional): The threat rating for this Indicator.</span>
<span class="sd">            confidence (str, optional): The threat confidence for this Indicator.</span>
<span class="sd">            xid (str, optional): The external id for this Indicator.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">CIDR</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">tcex</span><span class="p">,</span> <span class="s1">&#39;CIDR&#39;</span><span class="p">,</span> <span class="n">block</span><span class="p">,</span> <span class="n">rating</span><span class="p">,</span> <span class="n">confidence</span><span class="p">,</span> <span class="n">xid</span><span class="p">)</span></div>


<div class="viewcode-block" id="EmailAddress"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.EmailAddress">[docs]</a><span class="k">class</span> <span class="nc">EmailAddress</span><span class="p">(</span><span class="n">Indicator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;ThreatConnect Batch EmailAddress Object&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tcex</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">rating</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">confidence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize Class Properties.</span>

<span class="sd">        Args:</span>
<span class="sd">            tcex (obj): An instance of TcEx object.</span>
<span class="sd">            address (str): The value for this Indicator.</span>
<span class="sd">            rating (str, optional): The threat rating for this Indicator.</span>
<span class="sd">            confidence (str, optional): The threat confidence for this Indicator.</span>
<span class="sd">            xid (str, optional): The external id for this Indicator.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">EmailAddress</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">tcex</span><span class="p">,</span> <span class="s1">&#39;EmailAddress&#39;</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">rating</span><span class="p">,</span> <span class="n">confidence</span><span class="p">,</span> <span class="n">xid</span><span class="p">)</span></div>


<div class="viewcode-block" id="File"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.File">[docs]</a><span class="k">class</span> <span class="nc">File</span><span class="p">(</span><span class="n">Indicator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;ThreatConnect Batch File Object&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tcex</span><span class="p">,</span> <span class="n">md5</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sha1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sha256</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rating</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">confidence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize Class Properties.</span>

<span class="sd">        Args:</span>
<span class="sd">            tcex (obj): An instance of TcEx object.</span>
<span class="sd">            md5 (str, optional): The md5 value for this Indicator.</span>
<span class="sd">            sha1 (str, optional): The sha1 value for this Indicator.</span>
<span class="sd">            sha256 (str, optional): The sha256 value for this Indicator.</span>
<span class="sd">            size (str, optional): The file size for this Indicator.</span>
<span class="sd">            rating (str, optional): The threat rating for this Indicator.</span>
<span class="sd">            confidence (str, optional): The threat confidence for this Indicator.</span>
<span class="sd">            xid (str, optional): The external id for this Indicator.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span> <span class="o">=</span> <span class="n">tcex</span>
        <span class="n">summary</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_summary</span><span class="p">(</span><span class="n">md5</span><span class="p">,</span> <span class="n">sha1</span><span class="p">,</span> <span class="n">sha256</span><span class="p">)</span>  <span class="c1"># build the indicator summary</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">File</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">tcex</span><span class="p">,</span> <span class="s1">&#39;File&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">rating</span><span class="p">,</span> <span class="n">confidence</span><span class="p">,</span> <span class="n">xid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_indicator_data</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;File&#39;</span>
        <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_indicator_data</span><span class="p">[</span><span class="s1">&#39;intValue1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">size</span>
        <span class="c1"># self._file_action = []</span>

<div class="viewcode-block" id="File.action"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.File.action">[docs]</a>    <span class="k">def</span> <span class="nf">action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">relationship</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a File Action.&quot;&quot;&quot;</span>
        <span class="n">action_obj</span> <span class="o">=</span> <span class="n">FileAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_indicator_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xid&#39;</span><span class="p">),</span> <span class="n">relationship</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_file_actions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">action_obj</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">action_obj</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">md5</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return Indicator md5.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_indicator_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;md5&#39;</span><span class="p">)</span>

    <span class="nd">@md5</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">md5</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">md5</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set Indicator md5.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_indicator_data</span><span class="p">[</span><span class="s1">&#39;md5&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">md5</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">sha1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return Indicator sha1.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_indicator_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;sha1&#39;</span><span class="p">)</span>

    <span class="nd">@sha1</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">sha1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sha1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set Indicator sha1.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_indicator_data</span><span class="p">[</span><span class="s1">&#39;sha1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sha1</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">sha256</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return Indicator sha256.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_indicator_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;sha256&#39;</span><span class="p">)</span>

    <span class="nd">@sha256</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">sha256</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sha256</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set Indicator sha256.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_indicator_data</span><span class="p">[</span><span class="s1">&#39;sha256&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sha256</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return Indicator size.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_indicator_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;intValue1&#39;</span><span class="p">)</span>

    <span class="nd">@size</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set Indicator size.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_indicator_data</span><span class="p">[</span><span class="s1">&#39;intValue1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">size</span></div>


<div class="viewcode-block" id="Host"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.Host">[docs]</a><span class="k">class</span> <span class="nc">Host</span><span class="p">(</span><span class="n">Indicator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;ThreatConnect Batch Host Object&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tcex</span><span class="p">,</span> <span class="n">hostname</span><span class="p">,</span> <span class="n">dns_active</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">whois_active</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">rating</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">confidence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize Class Properties.</span>

<span class="sd">        Args:</span>
<span class="sd">            tcex (obj): An instance of TcEx object.</span>
<span class="sd">            hostname (str): The value for this Indicator.</span>
<span class="sd">            dns_active (bool, default:False): If True DNS active is enabled for this indicator.</span>
<span class="sd">            whois_active (bool, default:False): If True WhoIs active is enabled for this</span>
<span class="sd">                indicator.</span>
<span class="sd">            rating (str, optional): The threat rating for this Indicator.</span>
<span class="sd">            confidence (str, optional): The threat confidence for this Indicator.</span>
<span class="sd">            xid (str, optional): The external id for this Indicator.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Host</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">tcex</span><span class="p">,</span> <span class="s1">&#39;Host&#39;</span><span class="p">,</span> <span class="n">hostname</span><span class="p">,</span> <span class="n">rating</span><span class="p">,</span> <span class="n">confidence</span><span class="p">,</span> <span class="n">xid</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dns_active</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_indicator_data</span><span class="p">[</span><span class="s1">&#39;flag1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dns_active</span>
        <span class="k">if</span> <span class="n">whois_active</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_indicator_data</span><span class="p">[</span><span class="s1">&#39;flag2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dns_active</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dns_active</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return Indicator dns active.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_indicator_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;flag1&#39;</span><span class="p">)</span>

    <span class="nd">@dns_active</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">dns_active</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dns_active</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set Indicator dns active.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_indicator_data</span><span class="p">[</span><span class="s1">&#39;flag1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dns_active</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">whois_active</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return Indicator whois active.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_indicator_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;flag2&#39;</span><span class="p">)</span>

    <span class="nd">@whois_active</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">whois_active</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">whois_active</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set Indicator whois active.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_indicator_data</span><span class="p">[</span><span class="s1">&#39;flag2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">whois_active</span></div>


<div class="viewcode-block" id="Mutex"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.Mutex">[docs]</a><span class="k">class</span> <span class="nc">Mutex</span><span class="p">(</span><span class="n">Indicator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;ThreatConnect Batch Mutex Object&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tcex</span><span class="p">,</span> <span class="n">mutex</span><span class="p">,</span> <span class="n">rating</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">confidence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize Class Properties.</span>

<span class="sd">        Args:</span>
<span class="sd">            tcex (obj): An instance of TcEx object.</span>
<span class="sd">            mutex (str): The value for this Indicator.</span>
<span class="sd">            rating (str, optional): The threat rating for this Indicator.</span>
<span class="sd">            confidence (str, optional): The threat confidence for this Indicator.</span>
<span class="sd">            xid (str, optional): The external id for this Indicator.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Mutex</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">tcex</span><span class="p">,</span> <span class="s1">&#39;Mutex&#39;</span><span class="p">,</span> <span class="n">mutex</span><span class="p">,</span> <span class="n">rating</span><span class="p">,</span> <span class="n">confidence</span><span class="p">,</span> <span class="n">xid</span><span class="p">)</span></div>


<div class="viewcode-block" id="RegistryKey"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.RegistryKey">[docs]</a><span class="k">class</span> <span class="nc">RegistryKey</span><span class="p">(</span><span class="n">Indicator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;ThreatConnect Batch Registry Key Object&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tcex</span><span class="p">,</span> <span class="n">key_name</span><span class="p">,</span> <span class="n">value_name</span><span class="p">,</span> <span class="n">value_type</span><span class="p">,</span> <span class="n">rating</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">confidence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize Class Properties.</span>

<span class="sd">        Args:</span>
<span class="sd">            tcex (obj): An instance of TcEx object.</span>
<span class="sd">            key_name (str): The key_name value for this Indicator.</span>
<span class="sd">            value_name (str): The value_name value for this Indicator.</span>
<span class="sd">            value_type (str): The value_type value for this Indicator.</span>
<span class="sd">            rating (str, optional): The threat rating for this Indicator.</span>
<span class="sd">            confidence (str, optional): The threat confidence for this Indicator.</span>
<span class="sd">            xid (str, optional): The external id for this Indicator.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">summary</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_summary</span><span class="p">(</span><span class="n">key_name</span><span class="p">,</span> <span class="n">value_name</span><span class="p">,</span> <span class="n">value_type</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">RegistryKey</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">tcex</span><span class="p">,</span> <span class="s1">&#39;Registry Key&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">rating</span><span class="p">,</span> <span class="n">confidence</span><span class="p">,</span> <span class="n">xid</span><span class="p">)</span></div>


<div class="viewcode-block" id="URL"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.URL">[docs]</a><span class="k">class</span> <span class="nc">URL</span><span class="p">(</span><span class="n">Indicator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;ThreatConnect Batch URL Object&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tcex</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">rating</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">confidence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize Class Properties.</span>

<span class="sd">        Args:</span>
<span class="sd">            tcex (obj): An instance of TcEx object.</span>
<span class="sd">            text (str): The value for this Indicator.</span>
<span class="sd">            rating (str, optional): The threat rating for this Indicator.</span>
<span class="sd">            confidence (str, optional): The threat confidence for this Indicator.</span>
<span class="sd">            xid (str, optional): The external id for this Indicator.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">URL</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">tcex</span><span class="p">,</span> <span class="s1">&#39;URL&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">rating</span><span class="p">,</span> <span class="n">confidence</span><span class="p">,</span> <span class="n">xid</span><span class="p">)</span></div>


<div class="viewcode-block" id="UserAgent"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.UserAgent">[docs]</a><span class="k">class</span> <span class="nc">UserAgent</span><span class="p">(</span><span class="n">Indicator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;ThreatConnect Batch User Agent Object&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tcex</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">rating</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">confidence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize Class Properties.</span>

<span class="sd">        Args:</span>
<span class="sd">            tcex (obj): An instance of TcEx object.</span>
<span class="sd">            text (str): The value for this Indicator.</span>
<span class="sd">            rating (str, optional): The threat rating for this Indicator.</span>
<span class="sd">            confidence (str, optional): The threat confidence for this Indicator.</span>
<span class="sd">            xid (str, optional): The external id for this Indicator.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">UserAgent</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">tcex</span><span class="p">,</span> <span class="s1">&#39;User Agent&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">rating</span><span class="p">,</span> <span class="n">confidence</span><span class="p">,</span> <span class="n">xid</span><span class="p">)</span></div>


<span class="c1">#</span>
<span class="c1"># Metadata Classes</span>
<span class="c1">#</span>


<div class="viewcode-block" id="Attribute"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.Attribute">[docs]</a><span class="k">class</span> <span class="nc">Attribute</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;ThreatConnect Batch Attribute Object&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tcex</span><span class="p">,</span> <span class="n">attr_type</span><span class="p">,</span> <span class="n">attr_value</span><span class="p">,</span> <span class="n">displayed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">formatter</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize Class Properties.</span>

<span class="sd">        Args:</span>
<span class="sd">            tcex (obj): An instance of TcEx object.</span>
<span class="sd">            attr_type (str): The ThreatConnect defined attribute type.</span>
<span class="sd">            attr_value (str): The value for this attribute.</span>
<span class="sd">            displayed (bool, default:false): If True the supported attribute will be marked for</span>
<span class="sd">                display.</span>
<span class="sd">            source (str, optional): The source value for this attribute.</span>
<span class="sd">            formatter (method, optional): A method that take a single attribute value and return a</span>
<span class="sd">                single formatted value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span> <span class="o">=</span> <span class="n">tcex</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_attribute_data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">attr_type</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">displayed</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_attribute_data</span><span class="p">[</span><span class="s1">&#39;displayed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">displayed</span>
        <span class="c1"># format the value</span>
        <span class="k">if</span> <span class="n">formatter</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">attr_value</span> <span class="o">=</span> <span class="n">formatter</span><span class="p">(</span><span class="n">attr_value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_attribute_data</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">attr_value</span>
        <span class="c1"># add source if provided</span>
        <span class="k">if</span> <span class="n">source</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_attribute_data</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">source</span>
        <span class="c1"># is attr_value not null or &#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_valid</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">attr_value</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_valid</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return Attribute data.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attribute_data</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">displayed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return Attribute displayed.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attribute_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;displayed&#39;</span><span class="p">)</span>

    <span class="nd">@displayed</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">displayed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">displayed</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set Attribute displayed.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_attribute_data</span><span class="p">[</span><span class="s1">&#39;displayed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">displayed</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">source</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return Attribute source.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attribute_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;source&#39;</span><span class="p">)</span>

    <span class="nd">@source</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">source</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set Attribute source.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_attribute_data</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">source</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return attribute value.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attribute_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">valid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return valid value.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_valid</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return attribute value.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attribute_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="Attribute.__str__"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.Attribute.__str__">[docs]</a>    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return string represtentation of object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="FileAction"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.FileAction">[docs]</a><span class="k">class</span> <span class="nc">FileAction</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;ThreatConnect Batch FileAction Object&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tcex</span><span class="p">,</span> <span class="n">parent_xid</span><span class="p">,</span> <span class="n">relationship</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize Class Properties.</span>

<span class="sd">        .. warning:: This code is not complete and may require some update to the API.</span>

<span class="sd">        Args:</span>
<span class="sd">            tcex (obj): An instance of TcEx object.</span>
<span class="sd">            parent_xid (str): The external id of the parent Indicator.</span>
<span class="sd">            relationship: ???</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span> <span class="o">=</span> <span class="n">tcex</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xid</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_action_data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;indicatorXid&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">xid</span><span class="p">,</span>
            <span class="s1">&#39;relationship&#39;</span><span class="p">:</span> <span class="n">relationship</span><span class="p">,</span>
            <span class="s1">&#39;parentIndicatorXid&#39;</span><span class="p">:</span> <span class="n">parent_xid</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_children</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return File Occurrence data.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_action_data</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;children&#39;</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_action_data</span>

<div class="viewcode-block" id="FileAction.action"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.FileAction.action">[docs]</a>    <span class="k">def</span> <span class="nf">action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">relationship</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a nested File Action.&quot;&quot;&quot;</span>
        <span class="n">action_obj</span> <span class="o">=</span> <span class="n">FileAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xid</span><span class="p">,</span> <span class="n">relationship</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">action_obj</span><span class="p">)</span></div>

<div class="viewcode-block" id="FileAction.__str__"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.FileAction.__str__">[docs]</a>    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return string represtentation of object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="FileOccurrence"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.FileOccurrence">[docs]</a><span class="k">class</span> <span class="nc">FileOccurrence</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;ThreatConnect Batch FileAction Object.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tcex</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">date</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize Class Properties</span>

<span class="sd">        Args:</span>
<span class="sd">            tcex (TcEx Instance): Instance of TcEx</span>
<span class="sd">            file_name (str, optional): The file name for this occurrence.</span>
<span class="sd">            path (str, optional): The file path for this occurrence.</span>
<span class="sd">            date (str, optional): The datetime expression for this occurrence.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span> <span class="o">=</span> <span class="n">tcex</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_occurrence_data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">file_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_occurrence_data</span><span class="p">[</span><span class="s1">&#39;fileName&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">file_name</span>
        <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_occurrence_data</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">path</span>
        <span class="k">if</span> <span class="n">date</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_occurrence_data</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">format_datetime</span><span class="p">(</span>
                <span class="n">date</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">T%H:%M:%SZ&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return File Occurrence data.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_occurrence_data</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">date</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return File Occurrence date.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_occurrence_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;date&#39;</span><span class="p">)</span>

    <span class="nd">@date</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">date</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">date</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set File Occurrence date.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_occurrence_data</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">format_datetime</span><span class="p">(</span>
            <span class="n">date</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">T%H:%M:%SZ&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">file_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return File Occurrence file name.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_occurrence_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fileName&#39;</span><span class="p">)</span>

    <span class="nd">@file_name</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">file_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set File Occurrence file name.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_occurrence_data</span><span class="p">[</span><span class="s1">&#39;fileName&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">file_name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return File Occurrence path.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_occurrence_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">)</span>

    <span class="nd">@path</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set File Occurrence path.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_occurrence_data</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">path</span>

<div class="viewcode-block" id="FileOccurrence.__str__"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.FileOccurrence.__str__">[docs]</a>    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return string represtentation of object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="SecurityLabel"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.SecurityLabel">[docs]</a><span class="k">class</span> <span class="nc">SecurityLabel</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;ThreatConnect Batch SecurityLabel Object.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tcex</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize Class Properties.</span>

<span class="sd">        Args:</span>
<span class="sd">            tcex (obj): An instance of TcEx object.</span>
<span class="sd">            name (str): The value for this security label.</span>
<span class="sd">            description (str): A description for this security label.</span>
<span class="sd">            color (str): A color (hex value) for this security label.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span> <span class="o">=</span> <span class="n">tcex</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_label_data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">name</span><span class="p">}</span>
        <span class="c1"># add description if provided</span>
        <span class="k">if</span> <span class="n">description</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_label_data</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">description</span>
        <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_label_data</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">color</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">color</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return Security Label color.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_label_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">)</span>

    <span class="nd">@color</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">color</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set Security Label color.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_label_data</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">color</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return Security Label data.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_label_data</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">description</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return Security Label description.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_label_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;description&#39;</span><span class="p">)</span>

    <span class="nd">@description</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">description</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">description</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set Security Label description.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_label_data</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">description</span>

<div class="viewcode-block" id="SecurityLabel.__str__"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.SecurityLabel.__str__">[docs]</a>    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return string represtentation of object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Tag"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.Tag">[docs]</a><span class="k">class</span> <span class="nc">Tag</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;ThreatConnect Batch Tag Object&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tcex</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">formatter</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize Class Properties.</span>

<span class="sd">        Args:</span>
<span class="sd">            tcex (obj): An instance of TcEx object.</span>
<span class="sd">            name (str): The value for this tag.</span>
<span class="sd">            formatter (method, optional): A method that take a tag value and returns a</span>
<span class="sd">                formatted tag.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span> <span class="o">=</span> <span class="n">tcex</span>
        <span class="k">if</span> <span class="n">formatter</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">formatter</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tag_data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">name</span>
        <span class="p">}</span>
        <span class="c1"># is tag not null or &#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_valid</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_valid</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return Tag data.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tag_data</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return Tag name.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tag_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">valid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return valid data.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_valid</span>

<div class="viewcode-block" id="Tag.__str__"><a class="viewcode-back" href="../../tcex_docs/tcex.tcex_batch_v2.html#tcex.tcex_batch_v2.Tag.__str__">[docs]</a>    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return string represtentation of object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></div></div>
</pre></div>

           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, ThreatConnect Inc.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'0.8.10',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>