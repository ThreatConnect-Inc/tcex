

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Module: Threat Intelligence &mdash; TcEx 1.1.0 documentation</title>








  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>


      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>

    <script type="text/javascript" src="_static/js/theme.js"></script>




  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Module: Utils" href="module_utils.html" />
    <link rel="prev" title="Module: Resources" href="module_resource.html" />
</head>

<body class="wy-body-for-nav">


  <div class="wy-grid-for-nav">

    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >



            <a href="index.html" class="icon icon-home"> TcEx



          </a>




              <div class="version">
                1.1.0
              </div>




<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">






              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="features.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="building_apps_quickstart.html">Building Apps: Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="building_apps_tcinit.html">Building Apps: Templates (tcinit)</a></li>
<li class="toctree-l1"><a class="reference internal" href="building_apps_tclib.html">Building Apps: Dependencies (tclib)</a></li>
<li class="toctree-l1"><a class="reference internal" href="building_apps_tcpackage.html">Building Apps: Packaging (tcpackage)</a></li>
<li class="toctree-l1"><a class="reference internal" href="testing_apps_tcprofile.html">Testing Apps: Profiles (tcprofile)</a></li>
<li class="toctree-l1"><a class="reference internal" href="testing_apps_tcrun.html">Testing Apps: Running Profiles (tcrun)</a></li>
<li class="toctree-l1"><a class="reference internal" href="app_deployment_configuration.html">App-Deployment Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="app_directory_structure.html">App-Directory Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_batch.html">Module: Batch</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_metrics.html">Module: Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_notifications.html">Module: Notifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_playbook.html">Module: Playbooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_request.html">Module: Requests</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_resource.html">Module: Resources</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Module: Threat Intelligence</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#groups">Groups</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#get-groups-by-type">Get Groups by Type</a></li>
<li class="toctree-l3"><a class="reference internal" href="#get-groups-by-tag">Get Groups by Tag</a></li>
<li class="toctree-l3"><a class="reference internal" href="#get-groups-by-filter">Get Groups by Filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="#get-group-by-id">Get Group by ID</a></li>
<li class="toctree-l3"><a class="reference internal" href="#get-group-metadata">Get Group Metadata</a></li>
<li class="toctree-l3"><a class="reference internal" href="#create-a-group">Create a Group</a></li>
<li class="toctree-l3"><a class="reference internal" href="#updating-a-group">Updating a Group</a></li>
<li class="toctree-l3"><a class="reference internal" href="#delete-a-group">Delete a Group</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#indicators">Indicators</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#get-indicator-by-type">Get Indicator by Type</a></li>
<li class="toctree-l3"><a class="reference internal" href="#get-indicators-by-tag">Get Indicators by Tag</a></li>
<li class="toctree-l3"><a class="reference internal" href="#get-indicators-by-filter">Get Indicators by Filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="#get-indicator-by-value">Get Indicator by Value</a></li>
<li class="toctree-l3"><a class="reference internal" href="#get-indicator-metadata">Get Indicator Metadata</a></li>
<li class="toctree-l3"><a class="reference internal" href="#create-an-indicator">Create an Indicator</a></li>
<li class="toctree-l3"><a class="reference internal" href="#updating-an-indicator">Updating an Indicator</a></li>
<li class="toctree-l3"><a class="reference internal" href="#delete-an-indicator">Delete an Indicator</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#owners">Owners</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#get-available-owners">Get Available Owners</a></li>
<li class="toctree-l3"><a class="reference internal" href="#get-my-owners">Get My Owners</a></li>
<li class="toctree-l3"><a class="reference internal" href="#get-my-members">Get My Members</a></li>
<li class="toctree-l3"><a class="reference internal" href="#get-metrics">Get Metrics</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="module_utils.html">Module: Utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="authorization.html">Authorization (Token/HMAC)</a></li>
<li class="toctree-l1"><a class="reference internal" href="exit.html">Exit</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="message_tc.html">Message TC</a></li>
<li class="toctree-l1"><a class="reference internal" href="parser.html">Parser/Args</a></li>
<li class="toctree-l1"><a class="reference internal" href="proxies.html">Proxies</a></li>
<li class="toctree-l1"><a class="reference internal" href="results_tc.html">Results TC</a></li>
<li class="toctree-l1"><a class="reference internal" href="release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="tcex_docs/modules.html">TcEx Package</a></li>
</ul>



        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">


      <nav class="wy-nav-top" aria-label="top navigation">

          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">TcEx</a>

      </nav>


      <div class="wy-nav-content">

        <div class="rst-content">

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">

      <li><a href="index.html">Docs</a> &raquo;</li>

      <li>Module: Threat Intelligence</li>


      <li class="wy-breadcrumbs-aside">



      </li>

  </ul>


  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">

  <div class="section" id="module-threat-intelligence">
<span id="module-ti"></span><h1>Module: Threat Intelligence<a class="headerlink" href="#module-threat-intelligence" title="Permalink to this headline">¶</a></h1>
<p>The ThreatConnect TcEx Framework provides the <a class="reference internal" href="tcex_docs/tcex.tcex_ti.html#tcex.tcex_ti.tcex_ti.TcExTi" title="tcex.tcex_ti.tcex_ti.TcExTi"><code class="xref py py-mod docutils literal notranslate"><span class="pre">TcExTi</span></code></a> module, which creates, deletes, gets, and updates Groups, Indicators, Tasks, and Victims. The Threat Intelligence (TI) module also provides the ability to get Groups, Indicators, and Victims based on Tags, and it provides the ability to get Owners available to the API user in the ThreatConnect platform. The TI module returns a Python Requests Response object when requesting to create, delete, get, or update a single ThreatConnect object, and it yields the ThreatConnect object entity when requesting multiple objects. The Response object has the status code, headers, and body (response.text or response.json()) of the response, while the ThreatConnect object entity format varies depending on the type of object.</p>
<div class="section" id="groups">
<h2>Groups<a class="headerlink" href="#groups" title="Permalink to this headline">¶</a></h2>
<div class="section" id="get-groups-by-type">
<h3>Get Groups by Type<a class="headerlink" href="#get-groups-by-type" title="Permalink to this headline">¶</a></h3>
<p>To retrieve all Groups of a specific type from the ThreatConnect REST API, the group_type can be provided to the <code class="docutils literal notranslate"><span class="pre">group()</span></code> method. Once the Group object is initialized, the <code class="docutils literal notranslate"><span class="pre">many()</span></code> method allows pagination over all Groups.</p>
<p>The example below retrieves all Groups of type Adversary.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="hll"><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;includes&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;additional&#39;</span><span class="p">,</span> <span class="s1">&#39;attributes&#39;</span><span class="p">,</span> <span class="s1">&#39;labels&#39;</span><span class="p">,</span> <span class="s1">&#39;tags&#39;</span><span class="p">]}</span>
</span><span class="hll"><span class="n">groups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="n">group_type</span><span class="o">=</span><span class="s1">&#39;Adversary&#39;</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="s1">&#39;MyOrg&#39;</span><span class="p">)</span>
</span><span class="hll"><span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span><span class="o">.</span><span class="n">many</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="n">parameters</span><span class="p">):</span>
</span>    <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;group: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">group</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="get-groups-by-tag">
<h3>Get Groups by Tag<a class="headerlink" href="#get-groups-by-tag" title="Permalink to this headline">¶</a></h3>
<p>To retrieve all Groups with a specific Tag from the ThreatConnect REST API, the Tag name can be provided to the <code class="docutils literal notranslate"><span class="pre">tag()</span></code> method. Once the Tag object is initialized, the <code class="docutils literal notranslate"><span class="pre">groups()</span></code> method retrieves all Groups with that Tag and allows pagination over them.</p>
<p>The example below retrieves all Groups with a group of Crimeware.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="hll"><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;includes&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;additional&#39;</span><span class="p">,</span> <span class="s1">&#39;attributes&#39;</span><span class="p">,</span> <span class="s1">&#39;labels&#39;</span><span class="p">,</span> <span class="s1">&#39;tags&#39;</span><span class="p">]}</span>
</span><span class="hll"><span class="n">tag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="s1">&#39;Crimeware&#39;</span><span class="p">)</span>
</span><span class="hll"><span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">tag</span><span class="o">.</span><span class="n">groups</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="n">parameters</span><span class="p">):</span>
</span>    <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;group: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">group</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="get-groups-by-filter">
<h3>Get Groups by Filter<a class="headerlink" href="#get-groups-by-filter" title="Permalink to this headline">¶</a></h3>
<p>To retrieve all Groups using a Filter from the ThreatConnect REST API, the Filters can be provided to the <code class="docutils literal notranslate"><span class="pre">many()</span></code> method. The calling  <code class="docutils literal notranslate"><span class="pre">many()</span></code> method allows pagination over all Groups matching the provided Filter(s). The filters added should be the same filter parameters as the REST API expects.</p>
<p>The example below retrieves all Groups where the name equals <code class="docutils literal notranslate"><span class="pre">my_name_filter</span></code>.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="hll"><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;includes&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;additional&#39;</span><span class="p">,</span> <span class="s1">&#39;attributes&#39;</span><span class="p">,</span> <span class="s1">&#39;labels&#39;</span><span class="p">,</span> <span class="s1">&#39;tags&#39;</span><span class="p">]}</span>
</span><span class="hll"><span class="n">groups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="n">owner</span><span class="o">=</span><span class="s1">&#39;MyOrg&#39;</span><span class="p">)</span>
</span><span class="hll"><span class="n">filters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">filters</span><span class="p">()</span>
</span><span class="n">filters</span><span class="o">.</span><span class="n">add_filter</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="s1">&#39;my_name_filter&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span><span class="o">.</span><span class="n">many</span><span class="p">(</span><span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">parameters</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;group: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">group</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="get-group-by-id">
<h3>Get Group by ID<a class="headerlink" href="#get-group-by-id" title="Permalink to this headline">¶</a></h3>
<p>To retrieve a Group from the ThreatConnect REST API, the Group’s unique ID is required. Once the Group object is initialized, the <code class="docutils literal notranslate"><span class="pre">single</span></code> method will return the Group data from the API.</p>
<p>The example below retrieves a single Adversary with ID 416, if it exists.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="hll"><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;includes&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;additional&#39;</span><span class="p">,</span> <span class="s1">&#39;attributes&#39;</span><span class="p">,</span> <span class="s1">&#39;labels&#39;</span><span class="p">,</span> <span class="s1">&#39;tags&#39;</span><span class="p">]}</span>
</span><span class="hll"><span class="n">ti</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="n">group_type</span><span class="o">=</span><span class="s1">&#39;Adversary&#39;</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="s1">&#39;MyOrg&#39;</span><span class="p">,</span> <span class="n">unique_id</span><span class="o">=</span><span class="mi">416</span><span class="p">)</span>
</span><span class="hll"><span class="n">response</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">single</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="n">parameters</span><span class="p">)</span>
</span></pre></div>
</td></tr></table></div>
</div>
<div class="section" id="get-group-metadata">
<h3>Get Group Metadata<a class="headerlink" href="#get-group-metadata" title="Permalink to this headline">¶</a></h3>
<p>There are six methods that retrieve metadata for a Group: <code class="docutils literal notranslate"><span class="pre">group_associations()</span></code>, <code class="docutils literal notranslate"><span class="pre">indicator_associations()</span></code>, <code class="docutils literal notranslate"><span class="pre">attributes()</span></code>, <code class="docutils literal notranslate"><span class="pre">attributes()</span></code>, <code class="docutils literal notranslate"><span class="pre">tags()</span></code>, and <code class="docutils literal notranslate"><span class="pre">labels()</span></code>.  This data can also be retrieved in the initial API call by using the <code class="docutils literal notranslate"><span class="pre">include</span></code> query parameters.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">ti</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="n">group_type</span><span class="o">=</span><span class="s1">&#39;Adversary&#39;</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="s1">&#39;MyOrg&#39;</span><span class="p">,</span> <span class="n">unique_id</span><span class="o">=</span><span class="mi">416</span><span class="p">)</span>

<span class="c1"># get group associations</span>
<span class="k">for</span> <span class="n">association</span> <span class="ow">in</span> <span class="n">ti</span><span class="o">.</span><span class="n">group_associations</span><span class="p">():</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;association: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">association</span><span class="p">))</span>

<span class="c1"># get indicator associations</span>
<span class="k">for</span> <span class="n">association</span> <span class="ow">in</span> <span class="n">ti</span><span class="o">.</span><span class="n">indicator_associations</span><span class="p">():</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;association: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">association</span><span class="p">))</span>

<span class="c1"># get victim asset associations</span>
<span class="k">for</span> <span class="n">association</span> <span class="ow">in</span> <span class="n">ti</span><span class="o">.</span><span class="n">victim_asset_associations</span><span class="p">():</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;association: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">association</span><span class="p">))</span>

<span class="c1"># get attributes</span>
<span class="k">for</span> <span class="n">attribute</span> <span class="ow">in</span> <span class="n">ti</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;attribute: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">attribute</span><span class="p">))</span>

<span class="c1"># get tags</span>
<span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">ti</span><span class="o">.</span><span class="n">tags</span><span class="p">():</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;tag: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tag</span><span class="p">))</span>

<span class="c1"># get security labels</span>
<span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">ti</span><span class="o">.</span><span class="n">labels</span><span class="p">():</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;label: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">label</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="create-a-group">
<h3>Create a Group<a class="headerlink" href="#create-a-group" title="Permalink to this headline">¶</a></h3>
<p>Creating a Group and adding Associations and metadata constitute separate API calls, and each have their own Response object.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">ti</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="n">group_type</span><span class="o">=</span><span class="s1">&#39;Campaign&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;camp-3&#39;</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="s1">&#39;MyOrg&#39;</span><span class="p">,</span> <span class="n">first_seen</span><span class="o">=</span><span class="s1">&#39;2019-04-02&#39;</span><span class="p">)</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>

<span class="c1"># add associations</span>
<span class="n">group_assoc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="n">group_type</span><span class="o">=</span><span class="s1">&#39;Adversary&#39;</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="s1">&#39;MyOrg&#39;</span><span class="p">,</span> <span class="n">unique_id</span><span class="o">=</span><span class="mi">417</span><span class="p">)</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">add_association</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">group_assoc</span><span class="p">)</span>

<span class="c1"># add attributes</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">add_attribute</span><span class="p">(</span><span class="n">attribute_type</span><span class="o">=</span><span class="s1">&#39;Description&#39;</span><span class="p">,</span> <span class="n">attribute_value</span><span class="o">=</span><span class="s1">&#39;Example Description.&#39;</span><span class="p">)</span>

<span class="c1"># add security label</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">add_label</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;TLP:GREEN&#39;</span><span class="p">)</span>

<span class="c1"># add tag</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">add_tag</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Crimeware&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="updating-a-group">
<h3>Updating a Group<a class="headerlink" href="#updating-a-group" title="Permalink to this headline">¶</a></h3>
<p>Updating a Group is similar to creating a Group, with the addition of providing the Group ID.  The Group metadata can be updated using the same methods as were used in the Group Create example.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">ti</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="n">group_type</span><span class="o">=</span><span class="s1">&#39;Campaign&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;camp-3&#39;</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="s1">&#39;MyOrg&#39;</span><span class="p">,</span> <span class="n">first_seen</span><span class="o">=</span><span class="s1">&#39;2019-04-02&#39;</span><span class="p">,</span> <span class="n">unique_id</span><span class="o">=</span><span class="mi">4127</span><span class="p">)</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="delete-a-group">
<h3>Delete a Group<a class="headerlink" href="#delete-a-group" title="Permalink to this headline">¶</a></h3>
<p>Deleting a Group is similar to creating a Group, with the addition of providing the Group ID.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">ti</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="n">group_type</span><span class="o">=</span><span class="s1">&#39;Campaign&#39;</span><span class="p">,</span> <span class="n">unique_id</span><span class="o">=</span><span class="mi">4127</span><span class="p">)</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="indicators">
<h2>Indicators<a class="headerlink" href="#indicators" title="Permalink to this headline">¶</a></h2>
<div class="section" id="get-indicator-by-type">
<h3>Get Indicator by Type<a class="headerlink" href="#get-indicator-by-type" title="Permalink to this headline">¶</a></h3>
<p>To retrieve all Indicators of a specific type from the ThreatConnect REST API, the Indicator_type can be provided to the <code class="docutils literal notranslate"><span class="pre">indicator()</span></code> method. Once the Indicator object is initialized, the <code class="docutils literal notranslate"><span class="pre">many()</span></code> method allows pagination over all Indicators.</p>
<p>The example below retrieves all Indicators of type Address.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="hll"><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;includes&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;additional&#39;</span><span class="p">,</span> <span class="s1">&#39;attributes&#39;</span><span class="p">,</span> <span class="s1">&#39;labels&#39;</span><span class="p">,</span> <span class="s1">&#39;tags&#39;</span><span class="p">]}</span>
</span><span class="hll"><span class="n">indicators</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">indicator</span><span class="p">(</span><span class="n">indicator_type</span><span class="o">=</span><span class="s1">&#39;Address&#39;</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="s1">&#39;MyOrg&#39;</span><span class="p">)</span>
</span><span class="hll"><span class="k">for</span> <span class="n">indicator</span> <span class="ow">in</span> <span class="n">indicators</span><span class="o">.</span><span class="n">many</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="n">parameters</span><span class="p">):</span>
</span>    <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;indicator: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">indicator</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="get-indicators-by-tag">
<h3>Get Indicators by Tag<a class="headerlink" href="#get-indicators-by-tag" title="Permalink to this headline">¶</a></h3>
<p>To retrieve all Indicators with a specific Tag from the ThreatConnect REST API, the tag name can be provided to the <code class="docutils literal notranslate"><span class="pre">tag()</span></code> method. Once the Tag object is initialized, the <code class="docutils literal notranslate"><span class="pre">indicators()</span></code> method retrieves all Indicators with the Tag and allows pagination over them.</p>
<p>The example below retrieves all indicators with a tag of Crimeware.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="hll"><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;includes&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;additional&#39;</span><span class="p">,</span> <span class="s1">&#39;attributes&#39;</span><span class="p">,</span> <span class="s1">&#39;labels&#39;</span><span class="p">,</span> <span class="s1">&#39;tags&#39;</span><span class="p">]}</span>
</span><span class="hll"><span class="n">tag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="s1">&#39;Crimeware&#39;</span><span class="p">)</span>
</span><span class="hll"><span class="k">for</span> <span class="n">indicator</span> <span class="ow">in</span> <span class="n">tag</span><span class="o">.</span><span class="n">indicators</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="n">parameters</span><span class="p">):</span>
</span>    <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;indicator: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">indicator</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="get-indicators-by-filter">
<h3>Get Indicators by Filter<a class="headerlink" href="#get-indicators-by-filter" title="Permalink to this headline">¶</a></h3>
<p>To retrieve all Indicators using a Filter from the ThreatConnect REST API, the Filters can be provided to the <code class="docutils literal notranslate"><span class="pre">many()</span></code> method. Calling <code class="docutils literal notranslate"><span class="pre">many()</span></code> method allows pagination over all Indicators matching the provided Filter(s). The filters added should be the same filter parameters as the REST API expects.</p>
<p>The example below retrieves all Indicators where name equals <code class="docutils literal notranslate"><span class="pre">my_name_filter</span></code>.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="hll"><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;includes&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;additional&#39;</span><span class="p">,</span> <span class="s1">&#39;attributes&#39;</span><span class="p">,</span> <span class="s1">&#39;labels&#39;</span><span class="p">,</span> <span class="s1">&#39;tags&#39;</span><span class="p">]}</span>
</span><span class="hll"><span class="n">indicators</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">indicator</span><span class="p">(</span><span class="n">owner</span><span class="o">=</span><span class="s1">&#39;MyOrg&#39;</span><span class="p">)</span>
</span><span class="hll"><span class="n">filters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">filters</span><span class="p">()</span>
</span><span class="n">filters</span><span class="o">.</span><span class="n">add_filter</span><span class="p">(</span><span class="s1">&#39;summary&#39;</span><span class="p">,</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="s1">&#39;my_name_filter&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">indicator</span> <span class="ow">in</span> <span class="n">indicators</span><span class="o">.</span><span class="n">many</span><span class="p">(</span><span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">parameters</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;indicator: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">indicator</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="get-indicator-by-value">
<h3>Get Indicator by Value<a class="headerlink" href="#get-indicator-by-value" title="Permalink to this headline">¶</a></h3>
<p>To retrieve an Indicators from the ThreatConnect REST API, the Indicator’s unique Value and Owner are required. Once the Indicator object is initialized, the <code class="docutils literal notranslate"><span class="pre">single</span></code> method will return the Indicator data from the API.</p>
<p>The example below retrieves a single Address with Value 1.1.1.1, if it exists.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="hll"><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;includes&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;additional&#39;</span><span class="p">,</span> <span class="s1">&#39;attributes&#39;</span><span class="p">,</span> <span class="s1">&#39;labels&#39;</span><span class="p">,</span> <span class="s1">&#39;tags&#39;</span><span class="p">]}</span>
</span><span class="hll"><span class="n">ti</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">indicator</span><span class="p">(</span><span class="n">indicator_type</span><span class="o">=</span><span class="s1">&#39;Address&#39;</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="s1">&#39;MyOrg&#39;</span><span class="p">,</span> <span class="n">unique_id</span><span class="o">=</span><span class="s1">&#39;1.1.1.1&#39;</span><span class="p">)</span>
</span><span class="hll"><span class="n">response</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">single</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="n">parameters</span><span class="p">)</span>
</span></pre></div>
</td></tr></table></div>
</div>
<div class="section" id="get-indicator-metadata">
<h3>Get Indicator Metadata<a class="headerlink" href="#get-indicator-metadata" title="Permalink to this headline">¶</a></h3>
<p>There are six methods that retrieve metadata for an Indicator: <code class="docutils literal notranslate"><span class="pre">group_associations()</span></code>, <code class="docutils literal notranslate"><span class="pre">indicator_associations()</span></code>, <code class="docutils literal notranslate"><span class="pre">attributes()</span></code>, <code class="docutils literal notranslate"><span class="pre">attributes()</span></code>, <code class="docutils literal notranslate"><span class="pre">tags()</span></code>, and <code class="docutils literal notranslate"><span class="pre">labels()</span></code>.  This data can also be retrieved in the initial API call by using the <code class="docutils literal notranslate"><span class="pre">include</span></code> query parameters.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">ti</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">indicator</span><span class="p">(</span><span class="n">indicator_type</span><span class="o">=</span><span class="s1">&#39;Address&#39;</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="s1">&#39;MyOrg&#39;</span><span class="p">,</span> <span class="n">unique_id</span><span class="o">=</span><span class="s1">&#39;1.1.1.1&#39;</span><span class="p">)</span>

<span class="c1"># get group associations</span>
<span class="k">for</span> <span class="n">association</span> <span class="ow">in</span> <span class="n">ti</span><span class="o">.</span><span class="n">group_associations</span><span class="p">():</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;association: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">association</span><span class="p">))</span>

<span class="c1"># get indicator associations</span>
<span class="k">for</span> <span class="n">association</span> <span class="ow">in</span> <span class="n">ti</span><span class="o">.</span><span class="n">indicator_associations</span><span class="p">():</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;association: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">association</span><span class="p">))</span>

<span class="c1"># get attributes</span>
<span class="k">for</span> <span class="n">attribute</span> <span class="ow">in</span> <span class="n">ti</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;attribute: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">attribute</span><span class="p">))</span>

<span class="c1"># get tags</span>
<span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">ti</span><span class="o">.</span><span class="n">tags</span><span class="p">():</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;tag: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tag</span><span class="p">))</span>

<span class="c1"># get security labels</span>
<span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">ti</span><span class="o">.</span><span class="n">labels</span><span class="p">():</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;label: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">label</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="create-an-indicator">
<h3>Create an Indicator<a class="headerlink" href="#create-an-indicator" title="Permalink to this headline">¶</a></h3>
<p>Creating an Indicator and adding Associations and metadata are all separate API calls, and each have their own Response object.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">ti</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">indicator</span><span class="p">(</span><span class="n">indicator_type</span><span class="o">=</span><span class="s1">&#39;Address&#39;</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="s1">&#39;MyOrg&#39;</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="s1">&#39;12.13.14.15&#39;</span><span class="p">)</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>

<span class="c1"># add associations</span>
<span class="n">group_assoc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="n">group_type</span><span class="o">=</span><span class="s1">&#39;Adversary&#39;</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="s1">&#39;MyOrg&#39;</span><span class="p">,</span> <span class="n">unique_id</span><span class="o">=</span><span class="mi">417</span><span class="p">)</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">add_association</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">group_assoc</span><span class="p">)</span>

<span class="c1"># add attributes</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">add_attribute</span><span class="p">(</span><span class="n">attribute_type</span><span class="o">=</span><span class="s1">&#39;Description&#39;</span><span class="p">,</span> <span class="n">attribute_value</span><span class="o">=</span><span class="s1">&#39;Example Description.&#39;</span><span class="p">)</span>

<span class="c1"># add security label</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">add_label</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;TLP:GREEN&#39;</span><span class="p">)</span>

<span class="c1"># add tag</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">add_tag</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Crimeware&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="updating-an-indicator">
<h3>Updating an Indicator<a class="headerlink" href="#updating-an-indicator" title="Permalink to this headline">¶</a></h3>
<p>Updating an Indicator is similar to creating an Indicator, with the addition of providing the Indicator value.  The Indicator metadata can be updated using the same methods as were used in the Indicator Create example.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">ti</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">indicator</span><span class="p">(</span><span class="n">indicator_type</span><span class="o">=</span><span class="s1">&#39;Address&#39;</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="s1">&#39;MyOrg&#39;</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="s1">&#39;12.13.14.15&#39;</span><span class="p">)</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="delete-an-indicator">
<h3>Delete an Indicator<a class="headerlink" href="#delete-an-indicator" title="Permalink to this headline">¶</a></h3>
<p>Deleting an indicator is similar to creating an Indicator, with the addition of providing the Indicator value.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">ti</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">indicator</span><span class="p">(</span><span class="n">indicator_type</span><span class="o">=</span><span class="s1">&#39;Address&#39;</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="s1">&#39;MyOrg&#39;</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="s1">&#39;12.13.14.15&#39;</span><span class="p">)</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="owners">
<h2>Owners<a class="headerlink" href="#owners" title="Permalink to this headline">¶</a></h2>
<div class="section" id="get-available-owners">
<h3>Get Available Owners<a class="headerlink" href="#get-available-owners" title="Permalink to this headline">¶</a></h3>
<p>To retrieve all Owners available from the ThreatConnect REST API, the <code class="docutils literal notranslate"><span class="pre">owner</span></code> object can be used. The calling <code class="docutils literal notranslate"><span class="pre">many()</span></code> method allows pagination over all Owners available.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">ti</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">owner</span><span class="p">()</span>
<span class="k">for</span> <span class="n">owner</span> <span class="ow">in</span> <span class="n">ti</span><span class="o">.</span><span class="n">many</span><span class="p">():</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;owner: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">owner</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="get-my-owners">
<h3>Get My Owners<a class="headerlink" href="#get-my-owners" title="Permalink to this headline">¶</a></h3>
<p>To retrieve all Owners that are currently owned from the ThreatConnect REST API, the <code class="docutils literal notranslate"><span class="pre">owner</span></code> object can be used. The calling <code class="docutils literal notranslate"><span class="pre">mine()</span></code> method allows pagination over all Owners available.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">ti</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">owner</span><span class="p">()</span>
<span class="k">for</span> <span class="n">owner</span> <span class="ow">in</span> <span class="n">ti</span><span class="o">.</span><span class="n">mine</span><span class="p">():</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;owner: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">owner</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="get-my-members">
<h3>Get My Members<a class="headerlink" href="#get-my-members" title="Permalink to this headline">¶</a></h3>
<p>To retrieve all Members currently in Owners that are owned from the ThreatConnect REST API, the <code class="docutils literal notranslate"><span class="pre">owner</span></code> object can be used. The calling <code class="docutils literal notranslate"><span class="pre">members()</span></code> method allows pagination over all Members available.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">ti</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">owner</span><span class="p">()</span>
<span class="k">for</span> <span class="n">member</span> <span class="ow">in</span> <span class="n">ti</span><span class="o">.</span><span class="n">members</span><span class="p">():</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;member: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">member</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="get-metrics">
<h3>Get Metrics<a class="headerlink" href="#get-metrics" title="Permalink to this headline">¶</a></h3>
<p>To retrieve all Metrics from the ThreatConnect REST API, the <code class="docutils literal notranslate"><span class="pre">owner</span></code> object can be used. The calling <code class="docutils literal notranslate"><span class="pre">metrics()</span></code> method allows pagination over all Metrics available.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">ti</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">owner</span><span class="p">()</span>
<span class="k">for</span> <span class="n">metric</span> <span class="ow">in</span> <span class="n">ti</span><span class="o">.</span><span class="n">metrics</span><span class="p">():</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;metric: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">metric</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
</div>


           </div>

          </div>
          <footer>

    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">

        <a href="module_utils.html" class="btn btn-neutral float-right" title="Module: Utils" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>


        <a href="module_resource.html" class="btn btn-neutral float-left" title="Module: Resources" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>

    </div>


  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, ThreatConnect Inc

    </p>
  </div>

</footer>

        </div>
      </div>

    </section>

  </div>



  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>






</body>
</html>
